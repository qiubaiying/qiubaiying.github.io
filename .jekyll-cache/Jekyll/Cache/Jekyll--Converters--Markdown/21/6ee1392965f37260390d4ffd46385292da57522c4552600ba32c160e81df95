I"UÜ<h1 id="å‰è¨€">å‰è¨€</h1>

<blockquote>
  <p>åœ¨<a href="http://qiubaiying.github.io/2016/12/26/ReactiveCocoa-åŸºç¡€/">ä¸Šç¯‡æ–‡ç« </a>ä¸­ä»‹ç»äº†<strong>ReactiveCocoa</strong>çš„åŸºç¡€çŸ¥è¯†,æ¥ä¸‹æ¥æˆ‘ä»¬æ¥æ·±å…¥ä»‹ç»<strong>ReactiveCocoa</strong>åŠå…¶åœ¨<strong>MVVM</strong>ä¸­çš„ç”¨æ³•ã€‚</p>
</blockquote>

<p><img src="https://ww3.sinaimg.cn/large/006y8lVagw1fbgye3re5xj30je0iomz8.jpg" alt="ReactiveCocoaè¿›é˜¶æ€ç»´å¯¼å›¾" /></p>
<h1 id="å¸¸è§æ“ä½œæ–¹æ³•ä»‹ç»">å¸¸è§æ“ä½œæ–¹æ³•ä»‹ç»</h1>

<h4 id="æ“ä½œé¡»çŸ¥">æ“ä½œé¡»çŸ¥</h4>

<p>æ‰€æœ‰çš„ä¿¡å·ï¼ˆRACSignalï¼‰éƒ½å¯ä»¥è¿›è¡Œæ“ä½œå¤„ç†ï¼Œå› ä¸ºæ‰€æœ‰æ“ä½œæ–¹æ³•éƒ½å®šä¹‰åœ¨RACStream.hä¸­ï¼Œå› æ­¤åªè¦ç»§æ‰¿RACStreamå°±æœ‰äº†æ“ä½œå¤„ç†æ–¹æ³•ã€‚</p>
<h4 id="æ“ä½œæ€æƒ³">æ“ä½œæ€æƒ³</h4>

<p>è¿ç”¨çš„æ˜¯Hookï¼ˆé’©å­ï¼‰æ€æƒ³ï¼ŒHookæ˜¯ä¸€ç§ç”¨äºæ”¹å˜API(åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ï¼šæ–¹æ³•)æ‰§è¡Œç»“æœçš„æŠ€æœ¯.</p>

<p>Hookç”¨å¤„ï¼šæˆªè·APIè°ƒç”¨çš„æŠ€æœ¯ã€‚</p>

<p>æœ‰å…³Hookçš„çŸ¥è¯†å¯ä»¥çœ‹æˆ‘çš„è¿™ç¯‡åšå®¢<a href="http://www.jianshu.com/p/ff114e69cc0a">ã€ŠObjective-C Runtime çš„ä¸€äº›åŸºæœ¬ä½¿ç”¨ã€‹</a>ä¸­çš„ <em>æ›´æ¢ä»£ç çš„å®ç°æ–¹æ³•</em> ä¸€èŠ‚,</p>

<p>HookåŸç†ï¼šåœ¨æ¯æ¬¡è°ƒç”¨ä¸€ä¸ªAPIè¿”å›ç»“æœä¹‹å‰ï¼Œå…ˆæ‰§è¡Œä½ è‡ªå·±çš„æ–¹æ³•ï¼Œæ”¹å˜ç»“æœçš„è¾“å‡ºã€‚</p>

<h4 id="æ“ä½œæ–¹æ³•">æ“ä½œæ–¹æ³•</h4>

<h4 id="bindç»‘å®š--reactivecocoaæ ¸å¿ƒæ–¹æ³•"><strong>bind</strong>ï¼ˆç»‘å®šï¼‰- ReactiveCocoaæ ¸å¿ƒæ–¹æ³•</h4>

<p><strong>ReactiveCocoa</strong> æ“ä½œçš„æ ¸å¿ƒæ–¹æ³•æ˜¯ <strong>bind</strong>ï¼ˆç»‘å®šï¼‰,è€Œä¸”ä¹Ÿæ˜¯RACä¸­æ ¸å¿ƒå¼€å‘æ–¹å¼ã€‚ä¹‹å‰çš„å¼€å‘æ–¹å¼æ˜¯èµ‹å€¼ï¼Œè€Œç”¨RACå¼€å‘ï¼Œåº”è¯¥æŠŠé‡å¿ƒæ”¾åœ¨ç»‘å®šï¼Œä¹Ÿå°±æ˜¯å¯ä»¥åœ¨åˆ›å»ºä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œå°±ç»‘å®šå¥½ä»¥åæƒ³è¦åšçš„äº‹æƒ…ï¼Œè€Œä¸æ˜¯ç­‰èµ‹å€¼ä¹‹ååœ¨å»åšäº‹æƒ…ã€‚</p>

<p>åˆ—å¦‚ï¼ŒæŠŠæ•°æ®å±•ç¤ºåˆ°æ§ä»¶ä¸Šï¼Œä¹‹å‰éƒ½æ˜¯é‡å†™æ§ä»¶çš„ <code class="language-plaintext highlighter-rouge">setModel</code> æ–¹æ³•ï¼Œç”¨RACå°±å¯ä»¥åœ¨ä¸€å¼€å§‹åˆ›å»ºæ§ä»¶çš„æ—¶å€™ï¼Œå°±ç»‘å®šå¥½æ•°æ®ã€‚</p>

<ul>
  <li>
    <p><strong>ä½œç”¨</strong></p>

    <p>RACåº•å±‚éƒ½æ˜¯è°ƒç”¨<strong>bind</strong>ï¼Œ åœ¨å¼€å‘ä¸­å¾ˆå°‘ç›´æ¥ä½¿ç”¨ <strong>bind</strong> æ–¹æ³•ï¼Œ<strong>bind</strong>å±äºRACä¸­çš„åº•å±‚æ–¹æ³•ï¼Œæˆ‘ä»¬åªéœ€è¦è°ƒç”¨å°è£…å¥½çš„æ–¹æ³•ï¼Œ<strong>bind</strong>ç”¨ä½œäº†è§£å³å¯.</p>
  </li>
  <li><strong>bindæ–¹æ³•ä½¿ç”¨æ­¥éª¤</strong>
    <ol>
      <li>ä¼ å…¥ä¸€ä¸ªè¿”å›å€¼ <code class="language-plaintext highlighter-rouge">RACStreamBindBlock</code> çš„ blockã€‚</li>
      <li>æè¿°ä¸€ä¸ª <code class="language-plaintext highlighter-rouge">RACStreamBindBlock</code> ç±»å‹çš„ <code class="language-plaintext highlighter-rouge">bindBlock</code>ä½œä¸ºblockçš„è¿”å›å€¼ã€‚</li>
      <li>æè¿°ä¸€ä¸ªè¿”å›ç»“æœçš„ä¿¡å·ï¼Œä½œä¸º <code class="language-plaintext highlighter-rouge">bindBlock</code> çš„è¿”å›å€¼ã€‚</li>
    </ol>

    <p>æ³¨æ„ï¼šåœ¨bindBlockä¸­åšä¿¡å·ç»“æœçš„å¤„ç†ã€‚</p>
  </li>
  <li>
    <p><strong>bindæ–¹æ³•å‚æ•°</strong></p>

    <p><strong>RACStreamBindBlock</strong>:
<code class="language-plaintext highlighter-rouge">typedef RACStream * (^RACStreamBindBlock)(id value, BOOL *stop);</code></p>

    <p><code class="language-plaintext highlighter-rouge">å‚æ•°ä¸€(value)</code>:è¡¨ç¤ºæ¥æ”¶åˆ°ä¿¡å·çš„åŸå§‹å€¼ï¼Œè¿˜æ²¡åšå¤„ç†</p>

    <p><code class="language-plaintext highlighter-rouge">å‚æ•°äºŒ(*stop)</code>:ç”¨æ¥æ§åˆ¶ç»‘å®šBlockï¼Œå¦‚æœ*stop = yes,é‚£ä¹ˆå°±ä¼šç»“æŸç»‘å®šã€‚</p>

    <p><code class="language-plaintext highlighter-rouge">è¿”å›å€¼</code>ï¼šä¿¡å·ï¼Œåšå¥½å¤„ç†ï¼Œåœ¨é€šè¿‡è¿™ä¸ªä¿¡å·è¿”å›å‡ºå»ï¼Œä¸€èˆ¬ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">RACReturnSignal</code>,éœ€è¦æ‰‹åŠ¨å¯¼å…¥å¤´æ–‡ä»¶<code class="language-plaintext highlighter-rouge">RACReturnSignal.h</code></p>
  </li>
  <li>
    <p><strong>ä½¿ç”¨</strong></p>

    <p>å‡è®¾æƒ³ç›‘å¬æ–‡æœ¬æ¡†çš„å†…å®¹ï¼Œå¹¶ä¸”åœ¨æ¯æ¬¡è¾“å‡ºç»“æœçš„æ—¶å€™ï¼Œéƒ½åœ¨æ–‡æœ¬æ¡†çš„å†…å®¹æ‹¼æ¥ä¸€æ®µæ–‡å­—â€œè¾“å‡ºï¼šâ€</p>

    <ul>
      <li>
        <p>ä½¿ç”¨å°è£…å¥½çš„æ–¹æ³•ï¼šåœ¨è¿”å›ç»“æœåï¼Œæ‹¼æ¥ã€‚</p>

        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [_textField.rac_textSignal subscribeNext:^(id x) {
		
      // åœ¨è¿”å›ç»“æœåï¼Œæ‹¼æ¥ è¾“å‡ºï¼š
      NSLog(@"è¾“å‡º:%@",x);
		
  }];
</code></pre></div>        </div>
      </li>
      <li>
        <p>æ–¹å¼äºŒ:ï¼Œä½¿ç”¨RACä¸­ <code class="language-plaintext highlighter-rouge">bind</code> æ–¹æ³•åšå¤„ç†ï¼Œåœ¨è¿”å›ç»“æœå‰ï¼Œæ‹¼æ¥ã€‚</p>

        <p>è¿™é‡Œéœ€è¦æ‰‹åŠ¨å¯¼å…¥<code class="language-plaintext highlighter-rouge">#import &lt;ReactiveCocoa/RACReturnSignal.h&gt;</code>ï¼Œæ‰èƒ½ä½¿ç”¨<code class="language-plaintext highlighter-rouge">RACReturnSignal</code></p>

        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [[_textField.rac_textSignal bind:^RACStreamBindBlock{
     // ä»€ä¹ˆæ—¶å€™è°ƒç”¨:
     // blockä½œç”¨:è¡¨ç¤ºç»‘å®šäº†ä¸€ä¸ªä¿¡å·.
		
     return ^RACStream *(id value, BOOL *stop){
		
         // ä»€ä¹ˆæ—¶å€™è°ƒç”¨block:å½“ä¿¡å·æœ‰æ–°çš„å€¼å‘å‡ºï¼Œå°±ä¼šæ¥åˆ°è¿™ä¸ªblockã€‚
		
         // blockä½œç”¨:åšè¿”å›å€¼çš„å¤„ç†
		
         // åšå¥½å¤„ç†ï¼Œåœ¨è¿”å›ç»“æœå‰ï¼Œæ‹¼æ¥ è¾“å‡º:
         return [RACReturnSignal return:[NSString stringWithFormat:@"è¾“å‡º:%@",value]];
     };
		
  }] subscribeNext:^(id x) {
		
     NSLog(@"%@",x);
		
  }];

</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li><strong>åº•å±‚å®ç°</strong>
    <ol>
      <li>æºä¿¡å·è°ƒç”¨bind,ä¼šé‡æ–°åˆ›å»ºä¸€ä¸ªç»‘å®šä¿¡å·ã€‚</li>
      <li>å½“ç»‘å®šä¿¡å·è¢«è®¢é˜…ï¼Œå°±ä¼šè°ƒç”¨ç»‘å®šä¿¡å·ä¸­çš„ <code class="language-plaintext highlighter-rouge">didSubscribe</code> ï¼Œç”Ÿæˆä¸€ä¸ª <code class="language-plaintext highlighter-rouge">bindingBlock</code> ã€‚</li>
      <li>å½“æºä¿¡å·æœ‰å†…å®¹å‘å‡ºï¼Œå°±ä¼šæŠŠå†…å®¹ä¼ é€’åˆ° <code class="language-plaintext highlighter-rouge">bindingBlock</code> å¤„ç†ï¼Œè°ƒç”¨<code class="language-plaintext highlighter-rouge">bindingBlock(value,stop)</code></li>
      <li>è°ƒç”¨<code class="language-plaintext highlighter-rouge">bindingBlock(value,stop)</code>ï¼Œä¼šè¿”å›ä¸€ä¸ªå†…å®¹å¤„ç†å®Œæˆçš„ä¿¡å·<code class="language-plaintext highlighter-rouge">RACReturnSignal</code>ã€‚</li>
      <li>è®¢é˜…<code class="language-plaintext highlighter-rouge">RACReturnSignal</code>ï¼Œå°±ä¼šæ‹¿åˆ°ç»‘å®šä¿¡å·çš„è®¢é˜…è€…ï¼ŒæŠŠå¤„ç†å®Œæˆçš„ä¿¡å·å†…å®¹å‘é€å‡ºæ¥ã€‚</li>
    </ol>

    <p>æ³¨æ„:ä¸åŒè®¢é˜…è€…ï¼Œä¿å­˜ä¸åŒçš„nextBlockï¼Œçœ‹æºç çš„æ—¶å€™ï¼Œä¸€å®šè¦çœ‹æ¸…æ¥šè®¢é˜…è€…æ˜¯å“ªä¸ªã€‚</p>
  </li>
</ul>

<h4 id="æ˜ å°„">æ˜ å°„</h4>

<p>æ˜ å°„ä¸»è¦ç”¨è¿™ä¸¤ä¸ªæ–¹æ³•å®ç°ï¼š<strong>flattenMap</strong>,<strong>Map</strong>,ç”¨äºæŠŠæºä¿¡å·å†…å®¹æ˜ å°„æˆæ–°çš„å†…å®¹ã€‚</p>

<h6 id="flattenmap">flattenMap</h6>

<ul>
  <li>
    <p><strong>ä½œç”¨</strong></p>

    <p>æŠŠæºä¿¡å·çš„å†…å®¹æ˜ å°„æˆä¸€ä¸ªæ–°çš„ä¿¡å·ï¼Œä¿¡å·å¯ä»¥æ˜¯ä»»æ„ç±»å‹</p>
  </li>
  <li>
    <p><strong>ä½¿ç”¨æ­¥éª¤</strong></p>

    <ol>
      <li>ä¼ å…¥ä¸€ä¸ªblockï¼Œblockç±»å‹æ˜¯è¿”å›å€¼<code class="language-plaintext highlighter-rouge">RACStream</code>ï¼Œå‚æ•°value</li>
      <li>å‚æ•°valueå°±æ˜¯æºä¿¡å·çš„å†…å®¹ï¼Œæ‹¿åˆ°æºä¿¡å·çš„å†…å®¹åšå¤„ç†</li>
      <li>åŒ…è£…æˆ<code class="language-plaintext highlighter-rouge">RACReturnSignal</code>ä¿¡å·ï¼Œè¿”å›å‡ºå»ã€‚</li>
    </ol>
  </li>
  <li>
    <p><strong>ä½¿ç”¨</strong></p>

    <p>ç›‘å¬æ–‡æœ¬æ¡†çš„å†…å®¹æ”¹å˜ï¼ŒæŠŠç»“æ„é‡æ–°æ˜ å°„æˆä¸€ä¸ªæ–°å€¼.</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [[_textField.rac_textSignal flattenMap:^RACStream *(id value) {
        
      // blockè°ƒç”¨æ—¶æœºï¼šä¿¡å·æºå‘å‡ºçš„æ—¶å€™
        
      // blockä½œç”¨ï¼šæ”¹å˜ä¿¡å·çš„å†…å®¹
        
      // è¿”å›RACReturnSignal
      return [RACReturnSignal return:[NSString stringWithFormat:@"ä¿¡å·å†…å®¹ï¼š%@", value]];
        
  }] subscribeNext:^(id x) {
        
      NSLog(@"%@", x);
  }];
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>åº•å±‚å®ç°</strong></p>

    <ol>
      <li><strong>flattenMap</strong>å†…éƒ¨è°ƒç”¨ <code class="language-plaintext highlighter-rouge">bind</code> æ–¹æ³•å®ç°çš„,<strong>flattenMap</strong>ä¸­blockçš„è¿”å›å€¼ï¼Œä¼šä½œä¸ºbindä¸­bindBlockçš„è¿”å›å€¼ã€‚</li>
      <li>å½“è®¢é˜…ç»‘å®šä¿¡å·ï¼Œå°±ä¼šç”Ÿæˆ <code class="language-plaintext highlighter-rouge">bindBlock</code>ã€‚</li>
      <li>å½“æºä¿¡å·å‘é€å†…å®¹ï¼Œå°±ä¼šè°ƒç”¨<code class="language-plaintext highlighter-rouge"> bindBlock(value, *stop)</code></li>
      <li>è°ƒç”¨<code class="language-plaintext highlighter-rouge">bindBlock</code>ï¼Œå†…éƒ¨å°±ä¼šè°ƒç”¨ <strong>flattenMap</strong> çš„ bloc kï¼Œ<strong>flattenMap</strong> çš„blockä½œç”¨ï¼šå°±æ˜¯æŠŠå¤„ç†å¥½çš„æ•°æ®åŒ…è£…æˆä¿¡å·ã€‚</li>
      <li>è¿”å›çš„ä¿¡å·æœ€ç»ˆä¼šä½œä¸º <code class="language-plaintext highlighter-rouge">bindBlock</code> ä¸­çš„è¿”å›ä¿¡å·ï¼Œå½“åš <code class="language-plaintext highlighter-rouge">bindBlock</code> çš„è¿”å›ä¿¡å·ã€‚</li>
      <li>è®¢é˜… <code class="language-plaintext highlighter-rouge">bindBlock</code> çš„è¿”å›ä¿¡å·ï¼Œå°±ä¼šæ‹¿åˆ°ç»‘å®šä¿¡å·çš„è®¢é˜…è€…ï¼ŒæŠŠå¤„ç†å®Œæˆçš„ä¿¡å·å†…å®¹å‘é€å‡ºæ¥ã€‚</li>
    </ol>
  </li>
</ul>

<h6 id="map">Map</h6>

<ul>
  <li>
    <p><strong>ä½œç”¨</strong></p>

    <p>æŠŠæºä¿¡å·çš„å€¼æ˜ å°„æˆä¸€ä¸ªæ–°çš„å€¼</p>
  </li>
  <li><strong>ä½¿ç”¨æ­¥éª¤</strong>
    <ol>
      <li>ä¼ å…¥ä¸€ä¸ªblock,ç±»å‹æ˜¯è¿”å›å¯¹è±¡ï¼Œå‚æ•°æ˜¯ <code class="language-plaintext highlighter-rouge">value</code></li>
      <li><code class="language-plaintext highlighter-rouge">value</code>å°±æ˜¯æºä¿¡å·çš„å†…å®¹ï¼Œç›´æ¥æ‹¿åˆ°æºä¿¡å·çš„å†…å®¹åšå¤„ç†</li>
      <li>æŠŠå¤„ç†å¥½çš„å†…å®¹ï¼Œç›´æ¥è¿”å›å°±å¥½äº†ï¼Œä¸ç”¨åŒ…è£…æˆä¿¡å·ï¼Œè¿”å›çš„å€¼ï¼Œå°±æ˜¯æ˜ å°„çš„å€¼ã€‚</li>
    </ol>
  </li>
  <li>
    <p><strong>ä½¿ç”¨</strong></p>

    <p>ç›‘å¬æ–‡æœ¬æ¡†çš„å†…å®¹æ”¹å˜ï¼ŒæŠŠç»“æ„é‡æ–°æ˜ å°„æˆä¸€ä¸ªæ–°å€¼.</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [[_textField.rac_textSignal map:^id(id value) {
       
     // æ‹¼æ¥å®Œåï¼Œè¿”å›å¯¹è±¡
      return [NSString stringWithFormat:@"ä¿¡å·å†…å®¹: %@", value];
        
  }] subscribeNext:^(id x) {
        
      NSLog(@"%@", x);
  }];
</code></pre></div>    </div>
  </li>
  <li><strong>åº•å±‚å®ç°</strong>:
    <ol>
      <li>Mapåº•å±‚å…¶å®æ˜¯è°ƒç”¨ <code class="language-plaintext highlighter-rouge">flatternMa</code>p,<code class="language-plaintext highlighter-rouge">Map</code> ä¸­blockä¸­çš„è¿”å›çš„å€¼ä¼šä½œä¸º <code class="language-plaintext highlighter-rouge">flatternMap</code> ä¸­blockä¸­çš„å€¼</li>
      <li>å½“è®¢é˜…ç»‘å®šä¿¡å·ï¼Œå°±ä¼šç”Ÿæˆ <code class="language-plaintext highlighter-rouge">bindBlock</code></li>
      <li>å½“æºä¿¡å·å‘é€å†…å®¹ï¼Œå°±ä¼šè°ƒç”¨ <code class="language-plaintext highlighter-rouge">bindBlock(value, *stop)</code></li>
      <li>è°ƒç”¨ <code class="language-plaintext highlighter-rouge">bindBlock</code> ï¼Œå†…éƒ¨å°±ä¼šè°ƒç”¨ <code class="language-plaintext highlighter-rouge">flattenMapçš„block</code></li>
      <li><code class="language-plaintext highlighter-rouge">flattenMapçš„block</code> å†…éƒ¨ä¼šè°ƒç”¨ <code class="language-plaintext highlighter-rouge">Map</code> ä¸­çš„blockï¼ŒæŠŠ <code class="language-plaintext highlighter-rouge">Map</code> ä¸­çš„blockè¿”å›çš„å†…å®¹åŒ…è£…æˆè¿”å›çš„ä¿¡å·</li>
      <li>è¿”å›çš„ä¿¡å·æœ€ç»ˆä¼šä½œä¸º <code class="language-plaintext highlighter-rouge">bindBlock</code> ä¸­çš„è¿”å›ä¿¡å·ï¼Œå½“åš <code class="language-plaintext highlighter-rouge">bindBlock</code> çš„è¿”å›ä¿¡å·</li>
      <li>è®¢é˜… <code class="language-plaintext highlighter-rouge">bindBlock</code> çš„è¿”å›ä¿¡å·ï¼Œå°±ä¼šæ‹¿åˆ°ç»‘å®šä¿¡å·çš„è®¢é˜…è€…ï¼ŒæŠŠå¤„ç†å®Œæˆçš„ä¿¡å·å†…å®¹å‘é€å‡ºæ¥ã€‚</li>
    </ol>
  </li>
</ul>

<h6 id="flatternmap-å’Œ-map-çš„åŒºåˆ«">FlatternMap å’Œ Map çš„åŒºåˆ«</h6>
<ul>
  <li><strong>FlatternMap</strong> ä¸­çš„Block <strong>è¿”å›ä¿¡å·</strong>ã€‚
    <ol>
      <li><strong>Map</strong> ä¸­çš„Block <strong>è¿”å›å¯¹è±¡</strong>ã€‚</li>
      <li>å¼€å‘ä¸­ï¼Œå¦‚æœä¿¡å·å‘å‡ºçš„å€¼ <strong>ä¸æ˜¯ä¿¡å·</strong> ï¼Œæ˜ å°„ä¸€èˆ¬ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">Map</code></li>
      <li>å¦‚æœä¿¡å·å‘å‡ºçš„å€¼ <strong>æ˜¯ä¿¡å·</strong>ï¼Œæ˜ å°„ä¸€èˆ¬ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">FlatternMap</code>ã€‚</li>
    </ol>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">signalOfsignals</code>ç”¨ <strong>FlatternMap</strong></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  // åˆ›å»ºä¿¡å·ä¸­çš„ä¿¡å·
  RACSubject *signalOfsignals = [RACSubject subject];
  RACSubject *signal = [RACSubject subject];

  [[signalOfsignals flattenMap:^RACStream *(id value) {

   // å½“signalOfsignalsçš„signalså‘å‡ºä¿¡å·æ‰ä¼šè°ƒç”¨

      return value;

  }] subscribeNext:^(id x) {

      // åªæœ‰signalOfsignalsçš„signalå‘å‡ºä¿¡å·æ‰ä¼šè°ƒç”¨ï¼Œå› ä¸ºå†…éƒ¨è®¢é˜…äº†bindBlockä¸­è¿”å›çš„ä¿¡å·ï¼Œä¹Ÿå°±æ˜¯flattenMapè¿”å›çš„ä¿¡å·ã€‚
      // ä¹Ÿå°±æ˜¯flattenMapè¿”å›çš„ä¿¡å·å‘å‡ºå†…å®¹ï¼Œæ‰ä¼šè°ƒç”¨ã€‚

      NSLog(@"signalOfsignalsï¼š%@",x);
  }];

  // ä¿¡å·çš„ä¿¡å·å‘é€ä¿¡å·
  [signalOfsignals sendNext:signal];

  // ä¿¡å·å‘é€å†…å®¹
  [signal sendNext:@"hi"];
	
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="ç»„åˆ">ç»„åˆ</h4>

<p>ç»„åˆå°±æ˜¯å°†å¤šä¸ªä¿¡å·æŒ‰ç…§æŸç§è§„åˆ™è¿›è¡Œæ‹¼æ¥ï¼Œåˆæˆæ–°çš„ä¿¡å·ã€‚</p>

<h6 id="concat">concat</h6>

<ul>
  <li>
    <p><strong>ä½œç”¨</strong></p>

    <p>æŒ‰<strong>é¡ºåºæ‹¼æ¥</strong>ä¿¡å·ï¼Œå½“å¤šä¸ªä¿¡å·å‘å‡ºçš„æ—¶å€™ï¼Œæœ‰é¡ºåºçš„æ¥æ”¶ä¿¡å·ã€‚</p>
  </li>
  <li><strong>åº•å±‚å®ç°</strong>
    <ol>
      <li>å½“æ‹¼æ¥ä¿¡å·è¢«è®¢é˜…ï¼Œå°±ä¼šè°ƒç”¨æ‹¼æ¥ä¿¡å·çš„didSubscribe</li>
      <li>didSubscribeä¸­ï¼Œä¼šå…ˆè®¢é˜…ç¬¬ä¸€ä¸ªæºä¿¡å·ï¼ˆsignalAï¼‰</li>
      <li>ä¼šæ‰§è¡Œç¬¬ä¸€ä¸ªæºä¿¡å·ï¼ˆsignalAï¼‰çš„didSubscribe</li>
      <li>ç¬¬ä¸€ä¸ªæºä¿¡å·ï¼ˆsignalAï¼‰didSubscribeä¸­å‘é€å€¼ï¼Œå°±ä¼šè°ƒç”¨ç¬¬ä¸€ä¸ªæºä¿¡å·ï¼ˆsignalAï¼‰è®¢é˜…è€…çš„nextBlock,é€šè¿‡æ‹¼æ¥ä¿¡å·çš„è®¢é˜…è€…æŠŠå€¼å‘é€å‡ºæ¥.</li>
      <li>ç¬¬ä¸€ä¸ªæºä¿¡å·ï¼ˆsignalAï¼‰didSubscribeä¸­å‘é€å®Œæˆï¼Œå°±ä¼šè°ƒç”¨ç¬¬ä¸€ä¸ªæºä¿¡å·ï¼ˆsignalAï¼‰è®¢é˜…è€…çš„completedBlock,è®¢é˜…ç¬¬äºŒä¸ªæºä¿¡å·ï¼ˆsignalBï¼‰è¿™æ—¶å€™æ‰æ¿€æ´»ï¼ˆsignalBï¼‰ã€‚</li>
      <li>è®¢é˜…ç¬¬äºŒä¸ªæºä¿¡å·ï¼ˆsignalBï¼‰,æ‰§è¡Œç¬¬äºŒä¸ªæºä¿¡å·ï¼ˆsignalBï¼‰çš„didSubscribe</li>
      <li>ç¬¬äºŒä¸ªæºä¿¡å·ï¼ˆsignalAï¼‰didSubscribeä¸­å‘é€å€¼,å°±ä¼šé€šè¿‡æ‹¼æ¥ä¿¡å·çš„è®¢é˜…è€…æŠŠå€¼å‘é€å‡ºæ¥.</li>
    </ol>
  </li>
  <li>
    <p><strong>ä½¿ç”¨æ­¥éª¤</strong></p>

    <ol>
      <li>ä½¿ç”¨<code class="language-plaintext highlighter-rouge">concat:</code>æ‹¼æ¥ä¿¡å·</li>
      <li>è®¢é˜…æ‹¼æ¥ä¿¡å·ï¼Œå†…éƒ¨ä¼šè‡ªåŠ¨æŒ‰æ‹¼æ¥é¡ºåºè®¢é˜…ä¿¡å·</li>
    </ol>
  </li>
  <li>
    <p><strong>ä½¿ç”¨</strong></p>

    <p>æ‹¼æ¥ä¿¡å· <code class="language-plaintext highlighter-rouge">signalA</code>ã€ <code class="language-plaintext highlighter-rouge">signalB</code>ã€ <code class="language-plaintext highlighter-rouge">signalC</code></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  RACSignal *signalA = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) {
        
      [subscriber sendNext:@"Hello"];
        
      [subscriber sendCompleted];
        
      return nil;
  }];
    
  RACSignal *signalB = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) {
        
      [subscriber sendNext:@"World"];
        
      [subscriber sendCompleted];
        
      return nil;
  }];
    
  RACSignal *signalC = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) {
        
      [subscriber sendNext:@"!"];
        
      [subscriber sendCompleted];
        
      return nil;
  }];
    
  // æ‹¼æ¥ A B, æŠŠsignalAæ‹¼æ¥åˆ°signalBåï¼ŒsignalAå‘é€å®Œæˆï¼ŒsignalBæ‰ä¼šè¢«æ¿€æ´»ã€‚
  RACSignal *concatSignalAB = [signalA concat:signalB];
    
  // A B + C
  RACSignal *concatSignalABC = [concatSignalAB concat:signalC];
    
    
  // è®¢é˜…æ‹¼æ¥çš„ä¿¡å·, å†…éƒ¨ä¼šæŒ‰é¡ºåºè®¢é˜… A-&gt;B-&gt;C
  // æ³¨æ„ï¼šç¬¬ä¸€ä¸ªä¿¡å·å¿…é¡»å‘é€å®Œæˆï¼Œç¬¬äºŒä¸ªä¿¡å·æ‰ä¼šè¢«æ¿€æ´»...
  [concatSignalABC subscribeNext:^(id x) {
        
      NSLog(@"%@", x);
  }];
</code></pre></div>    </div>
  </li>
</ul>

<h6 id="then">then</h6>
<ul>
  <li>
    <p><strong>ä½œç”¨</strong></p>

    <p>ç”¨äºè¿æ¥ä¸¤ä¸ªä¿¡å·ï¼Œå½“ç¬¬ä¸€ä¸ªä¿¡å·å®Œæˆï¼Œæ‰ä¼šè¿æ¥thenè¿”å›çš„ä¿¡å·ã€‚</p>
  </li>
  <li>
    <p><strong>åº•å±‚å®ç°</strong></p>

    <ol>
      <li>å…ˆè¿‡æ»¤æ‰ä¹‹å‰çš„ä¿¡å·å‘å‡ºçš„å€¼</li>
      <li>ä½¿ç”¨concatè¿æ¥thenè¿”å›çš„ä¿¡å·</li>
    </ol>
  </li>
  <li>
    <p><strong>ä½¿ç”¨</strong></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> [[[RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) {
      
    [subscriber sendNext:@1];
      
    [subscriber sendCompleted];
      
    return nil;
      
  }] then:^RACSignal *{
      
    	return [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) {
          
        [subscriber sendNext:@2];
          
        return nil;
    }];
      
  }] subscribeNext:^(id x) {
      
    // åªèƒ½æ¥æ”¶åˆ°ç¬¬äºŒä¸ªä¿¡å·çš„å€¼ï¼Œä¹Ÿå°±æ˜¯thenè¿”å›ä¿¡å·çš„å€¼
    NSLog(@"%@", x);
      
  }];
    
  ///
  è¾“å‡ºï¼š2
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>æ³¨æ„</strong></p>

    <p>æ³¨æ„ä½¿ç”¨<code class="language-plaintext highlighter-rouge">then</code>ï¼Œä¹‹å‰ä¿¡å·çš„å€¼ä¼šè¢«å¿½ç•¥æ‰.</p>
  </li>
</ul>

<h6 id="merge">merge</h6>
<ul>
  <li>
    <p><strong>ä½œç”¨</strong></p>

    <p>åˆå¹¶ä¿¡å·,ä»»ä½•ä¸€ä¸ªä¿¡å·å‘é€æ•°æ®ï¼Œéƒ½èƒ½ç›‘å¬åˆ°.</p>
  </li>
  <li>
    <p><strong>åº•å±‚å®ç°</strong></p>

    <ol>
      <li>åˆå¹¶ä¿¡å·è¢«è®¢é˜…çš„æ—¶å€™ï¼Œå°±ä¼šéå†æ‰€æœ‰ä¿¡å·ï¼Œå¹¶ä¸”å‘å‡ºè¿™äº›ä¿¡å·ã€‚</li>
      <li>æ¯å‘å‡ºä¸€ä¸ªä¿¡å·ï¼Œè¿™ä¸ªä¿¡å·å°±ä¼šè¢«è®¢é˜…</li>
      <li>ä¹Ÿå°±æ˜¯åˆå¹¶ä¿¡å·ä¸€è¢«è®¢é˜…ï¼Œå°±ä¼šè®¢é˜…é‡Œé¢æ‰€æœ‰çš„ä¿¡å·ã€‚</li>
      <li>åªè¦æœ‰ä¸€ä¸ªä¿¡å·è¢«å‘å‡ºå°±ä¼šè¢«ç›‘å¬ã€‚</li>
    </ol>
  </li>
  <li>
    <p><strong>ä½¿ç”¨</strong></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  RACSignal *signalA = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) {
        
      [subscriber sendNext:@"A"];
        
      return nil;
  }];

  RACSignal *signalB = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) {
        
      [subscriber sendNext:@"B"];
        
      return nil;
  }];

  // åˆå¹¶ä¿¡å·, ä»»ä½•ä¸€ä¸ªä¿¡å·å‘é€æ•°æ®ï¼Œéƒ½èƒ½ç›‘å¬åˆ°
  RACSignal *mergeSianl = [signalA merge:signalB];

  [mergeSianl subscribeNext:^(id x) {
        
      NSLog(@"%@", x);
  }];
    
  // è¾“å‡º
  2017-01-03 13:29:08.013 ReactiveCocoaè¿›é˜¶[3627:718315] A
  2017-01-03 13:29:08.014 ReactiveCocoaè¿›é˜¶[3627:718315] B

    
</code></pre></div>    </div>
  </li>
</ul>

<h6 id="zip">zip</h6>

<ul>
  <li>
    <p><strong>ä½œç”¨</strong></p>

    <p>æŠŠä¸¤ä¸ªä¿¡å·å‹ç¼©æˆä¸€ä¸ªä¿¡å·ï¼Œåªæœ‰å½“ä¸¤ä¸ªä¿¡å· <strong>åŒæ—¶</strong> å‘å‡ºä¿¡å·å†…å®¹æ—¶ï¼Œå¹¶ä¸”æŠŠä¸¤ä¸ªä¿¡å·çš„å†…å®¹åˆå¹¶æˆä¸€ä¸ªå…ƒç»„ï¼Œæ‰ä¼šè§¦å‘å‹ç¼©æµçš„nextäº‹ä»¶ã€‚</p>
  </li>
  <li>
    <p><strong>åº•å±‚å®ç°</strong></p>

    <ol>
      <li>å®šä¹‰å‹ç¼©ä¿¡å·ï¼Œå†…éƒ¨å°±ä¼šè‡ªåŠ¨è®¢é˜…signalAï¼ŒsignalB</li>
      <li>æ¯å½“signalAæˆ–è€…signalBå‘å‡ºä¿¡å·ï¼Œå°±ä¼šåˆ¤æ–­signalAï¼ŒsignalBæœ‰æ²¡æœ‰å‘å‡ºä¸ªä¿¡å·ï¼Œæœ‰å°±ä¼šæŠŠæ¯ä¸ªä¿¡å· ç¬¬ä¸€æ¬¡ å‘å‡ºçš„å€¼åŒ…è£…æˆå…ƒç»„å‘å‡º</li>
    </ol>
  </li>
  <li>
    <p><strong>ä½¿ç”¨</strong></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  RACSignal *signalA = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) {
        
      [subscriber sendNext:@"A1"];
      [subscriber sendNext:@"A2"];
        
      return nil;
  }];
    
  RACSignal *signalB = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) {
        
      [subscriber sendNext:@"B1"];
      [subscriber sendNext:@"B2"];
      [subscriber sendNext:@"B3"];
        
      return nil;
  }];
    
  RACSignal *zipSignal = [signalA zipWith:signalB];
    
  [zipSignal subscribeNext:^(id x) {
        
      NSLog(@"%@", x);
  }];
	
  // è¾“å‡º
  2017-01-03 13:48:09.234 ReactiveCocoaè¿›é˜¶[3997:789720] zipWith: &lt;RACTuple: 0x600000004df0&gt; (
  A1,
  B1
  )
  2017-01-03 13:48:09.234 ReactiveCocoaè¿›é˜¶[3997:789720] zipWith: &lt;RACTuple: 0x608000003410&gt; (
  A2,
  B2
  )
</code></pre></div>    </div>
  </li>
</ul>

<h6 id="combinelatest">combineLatest</h6>
<ul>
  <li>
    <p><strong>ä½œç”¨</strong></p>

    <p>å°†å¤šä¸ªä¿¡å·åˆå¹¶èµ·æ¥ï¼Œå¹¶ä¸”æ‹¿åˆ°å„ä¸ªä¿¡å·æœ€åä¸€ä¸ªå€¼,å¿…é¡»æ¯ä¸ªåˆå¹¶çš„signalè‡³å°‘éƒ½æœ‰è¿‡ä¸€æ¬¡sendNextï¼Œæ‰ä¼šè§¦å‘åˆå¹¶çš„ä¿¡å·ã€‚</p>
  </li>
  <li>
    <p><strong>åº•å±‚å®ç°</strong></p>
  </li>
</ul>

 	1. å½“ç»„åˆä¿¡å·è¢«è®¢é˜…ï¼Œå†…éƒ¨ä¼šè‡ªåŠ¨è®¢é˜…signalAï¼ŒsignalB,å¿…é¡»ä¸¤ä¸ªä¿¡å·éƒ½å‘å‡ºå†…å®¹ï¼Œæ‰ä¼šè¢«è§¦å‘ã€‚
 	2. å¹¶ä¸”æŠŠä¸¤ä¸ªä¿¡å·çš„ æœ€åä¸€æ¬¡ å‘é€çš„å€¼ç»„åˆæˆå…ƒç»„å‘å‡ºã€‚

<ul>
  <li>
    <p><strong>ä½¿ç”¨</strong></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  RACSignal *signalA = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) {
        
      [subscriber sendNext:@"A1"];
      [subscriber sendNext:@"A2"];
        
      return nil;
  }];
    
  RACSignal *signalB = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) {
        
      [subscriber sendNext:@"B1"];
      [subscriber sendNext:@"B2"];
      [subscriber sendNext:@"B3"];
        
      return nil;
  }];
    
  RACSignal *combineSianal = [signalA combineLatestWith:signalB];
    
  [combineSianal subscribeNext:^(id x) {
        
      NSLog(@"combineLatest:%@", x);
  }];
	
  // è¾“å‡º
  2017-01-03 13:48:09.235 ReactiveCocoaè¿›é˜¶[3997:789720] combineLatest:&lt;RACTuple: 0x60800000e150&gt; (
  A2,
  B1
  )
  2017-01-03 13:48:09.235 ReactiveCocoaè¿›é˜¶[3997:789720] combineLatest:&lt;RACTuple: 0x600000004db0&gt; (
  A2,
  B2
  )
  2017-01-03 13:48:09.236 ReactiveCocoaè¿›é˜¶[3997:789720] combineLatest:&lt;RACTuple: 0x60800000e180&gt; (
  A2,
  B3
  )
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>æ³¨æ„</strong></p>

    <p><strong>combineLatest</strong>ä¸<strong>zip</strong>ç”¨æ³•ç›¸ä¼¼ï¼Œå¿…é¡»æ¯ä¸ªåˆå¹¶çš„signalè‡³å°‘éƒ½æœ‰è¿‡ä¸€æ¬¡sendNextï¼Œæ‰ä¼šè§¦å‘åˆå¹¶çš„ä¿¡å·ã€‚</p>

    <p>åŒºåˆ«çœ‹ä¸‹å›¾ï¼š</p>

    <p><img src="https://ww2.sinaimg.cn/large/006y8lVagw1fbdf6cyez6j30id0kkabf.jpg" alt="" /></p>
  </li>
</ul>

<h6 id="reduce">reduce</h6>

<ul>
  <li>
    <p><strong>ä½œç”¨</strong></p>

    <p>æŠŠä¿¡å·å‘å‡ºå…ƒç»„çš„å€¼èšåˆæˆä¸€ä¸ªå€¼</p>
  </li>
  <li>
    <p><strong>åº•å±‚å®ç°</strong></p>
  </li>
</ul>

 	1. è®¢é˜…èšåˆä¿¡å·ï¼Œ
 	2. æ¯æ¬¡æœ‰å†…å®¹å‘å‡ºï¼Œå°±ä¼šæ‰§è¡Œreduceblcokï¼ŒæŠŠä¿¡å·å†…å®¹è½¬æ¢æˆreduceblcokè¿”å›çš„å€¼ã€‚

<ul>
  <li>
    <p><strong>ä½¿ç”¨</strong></p>

    <p>å¸¸è§çš„ç”¨æ³•ï¼Œï¼ˆå…ˆç»„åˆåœ¨èšåˆï¼‰<code class="language-plaintext highlighter-rouge">combineLatest:(id&lt;NSFastEnumeration&gt;)signals reduce:(id (^)())reduceBlock</code></p>

    <p>reduceä¸­çš„blockç®€ä»‹:</p>

    <p>reduceblcokä¸­çš„å‚æ•°ï¼Œæœ‰å¤šå°‘ä¿¡å·ç»„åˆï¼Œreduceblcokå°±æœ‰å¤šå°‘å‚æ•°ï¼Œæ¯ä¸ªå‚æ•°å°±æ˜¯ä¹‹å‰ä¿¡å·å‘å‡ºçš„å†…å®¹
   reduceblcokçš„è¿”å›å€¼ï¼šèšåˆä¿¡å·ä¹‹åçš„å†…å®¹ã€‚</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      RACSignal *signalA = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) {
        
      [subscriber sendNext:@"A1"];
      [subscriber sendNext:@"A2"];
        
      return nil;
  }];
    
  RACSignal *signalB = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) {
        
      [subscriber sendNext:@"B1"];
      [subscriber sendNext:@"B2"];
      [subscriber sendNext:@"B3"];
        
      return nil;
  }];
    
    
  RACSignal *reduceSignal = [RACSignal combineLatest:@[signalA, signalB] reduce:^id(NSString *str1, NSString *str2){
        
      return [NSString stringWithFormat:@"%@ %@", str1, str2];
  }];
    
  [reduceSignal subscribeNext:^(id x) {
        
      NSLog(@"%@", x);
  }];
    
  // è¾“å‡º
  2017-01-03 15:42:41.803 ReactiveCocoaè¿›é˜¶[4248:1264674] A2 B1
  2017-01-03 15:42:41.803 ReactiveCocoaè¿›é˜¶[4248:1264674] A2 B2
  2017-01-03 15:42:41.803 ReactiveCocoaè¿›é˜¶[4248:1264674] A2 B3
    
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="è¿‡æ»¤">è¿‡æ»¤</h4>

<p>è¿‡æ»¤å°±æ˜¯è¿‡æ»¤ä¿¡å·ä¸­çš„ ç‰¹å®šå€¼ ï¼Œæˆ–è€…è¿‡æ»¤æŒ‡å®š å‘é€æ¬¡æ•° çš„ä¿¡å·ã€‚</p>

<h6 id="filter">filter</h6>

<ul>
  <li>
    <p><strong>ä½œç”¨</strong></p>

    <p>è¿‡æ»¤ä¿¡å·ï¼Œä½¿ç”¨å®ƒå¯ä»¥è·å–æ»¡è¶³æ¡ä»¶çš„ä¿¡å·.</p>

    <p>blockçš„è¿”å›å€¼æ˜¯Boolå€¼ï¼Œè¿”å›<code class="language-plaintext highlighter-rouge">NO</code>åˆ™è¿‡æ»¤è¯¥ä¿¡å·</p>
  </li>
  <li>
    <p><strong>ä½¿ç”¨</strong></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  // è¿‡æ»¤:
  // æ¯æ¬¡ä¿¡å·å‘å‡ºï¼Œä¼šå…ˆæ‰§è¡Œè¿‡æ»¤æ¡ä»¶åˆ¤æ–­.
  [[_textField.rac_textSignal filter:^BOOL(NSString *value) {
        
      NSLog(@"åŸä¿¡å·: %@", value);

      // è¿‡æ»¤ é•¿åº¦ &lt;= 3 çš„ä¿¡å·
      return value.length &gt; 3;
        
  }] subscribeNext:^(id x) {
        
      NSLog(@"é•¿åº¦å¤§äº3çš„ä¿¡å·ï¼š%@", x);
  }];
    
  // åœ¨_textFieldä¸­è¾“å‡º12345
  // è¾“å‡º
  2017-01-03 16:36:54.938 ReactiveCocoaè¿›é˜¶[4714:1552910] åŸä¿¡å·: 1
  2017-01-03 16:36:55.383 ReactiveCocoaè¿›é˜¶[4714:1552910] åŸä¿¡å·: 12
  2017-01-03 16:36:55.706 ReactiveCocoaè¿›é˜¶[4714:1552910] åŸä¿¡å·: 123
  2017-01-03 16:36:56.842 ReactiveCocoaè¿›é˜¶[4714:1552910] åŸä¿¡å·: 1234
  2017-01-03 16:36:56.842 ReactiveCocoaè¿›é˜¶[4714:1552910] é•¿åº¦å¤§äº3çš„ä¿¡å·ï¼š1234
  2017-01-03 16:36:58.350 ReactiveCocoaè¿›é˜¶[4714:1552910] åŸä¿¡å·: 12345
  2017-01-03 16:36:58.351 ReactiveCocoaè¿›é˜¶[4714:1552910] é•¿åº¦å¤§äº3çš„ä¿¡å·ï¼š12345
</code></pre></div>    </div>
  </li>
</ul>

<h6 id="ignore">ignore</h6>

<ul>
  <li>
    <p><strong>ä½œç”¨</strong></p>

    <p>å¿½ç•¥æŸäº›ä¿¡å·.</p>
  </li>
  <li>
    <p><strong>ä½¿ç”¨</strong></p>
  </li>
  <li>
    <p><strong>ä½œç”¨</strong></p>

    <p>å¿½ç•¥æŸäº›å€¼çš„ä¿¡å·.</p>

    <p>åº•å±‚è°ƒç”¨äº† <code class="language-plaintext highlighter-rouge">filter</code> ä¸ è¿‡æ»¤å€¼è¿›è¡Œæ¯”è¾ƒï¼Œè‹¥ç›¸ç­‰è¿”å›åˆ™ <code class="language-plaintext highlighter-rouge">NO</code></p>
  </li>
  <li>
    <p><strong>ä½¿ç”¨</strong></p>

    <p>```
	// å†…éƒ¨è°ƒç”¨filterè¿‡æ»¤ï¼Œå¿½ç•¥æ‰å­—ç¬¦ä¸º @â€œ1â€çš„å€¼
[[_textField.rac_textSignal ignore:@â€1â€] subscribeNext:^(id x) {</p>
  </li>
</ul>

 	 NSLog(@â€%@â€,x);
<p>}];</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>```
</code></pre></div></div>

<h6 id="distinctuntilchanged">distinctUntilChanged</h6>

<ul>
  <li>
    <p><strong>ä½œç”¨</strong></p>

    <p>å½“ä¸Šä¸€æ¬¡çš„å€¼å’Œå½“å‰çš„å€¼æœ‰æ˜æ˜¾çš„å˜åŒ–å°±ä¼šå‘å‡ºä¿¡å·ï¼Œå¦åˆ™ä¼šè¢«å¿½ç•¥æ‰ã€‚</p>
  </li>
  <li>
    <p><strong>ä½¿ç”¨</strong></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [[_textField.rac_textSignal distinctUntilChanged] subscribeNext:^(id x) {
        
      NSLog(@"%@",x);
  }];
</code></pre></div>    </div>
  </li>
</ul>

<h6 id="skip">skip</h6>

<ul>
  <li>
    <p><strong>ä½œç”¨</strong></p>

    <p>è·³è¿‡ <strong>ç¬¬Næ¬¡</strong> çš„å‘é€çš„ä¿¡å·.</p>
  </li>
  <li>
    <p><strong>ä½¿ç”¨</strong></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// è¡¨ç¤ºè¾“å…¥ç¬¬ä¸€æ¬¡ï¼Œä¸ä¼šè¢«ç›‘å¬åˆ°ï¼Œè·³è¿‡ç¬¬ä¸€æ¬¡å‘å‡ºçš„ä¿¡å·
[[_textField.rac_textSignal skip:1] subscribeNext:^(id x) {

 NSLog(@"%@",x);
}];
</code></pre></div>    </div>
  </li>
</ul>

<h5 id="take">take</h5>
<ul>
  <li>
    <p><strong>ä½œç”¨</strong></p>

    <p>å– <strong>å‰Næ¬¡</strong> çš„å‘é€çš„ä¿¡å·.</p>
  </li>
  <li>
    <p><strong>ä½¿ç”¨</strong></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  RACSubject *subject = [RACSubject subject] ;
    
  // å– å‰ä¸¤æ¬¡ å‘é€çš„ä¿¡å·
  [[subject take:2] subscribeNext:^(id x) {
        
      NSLog(@"%@", x);
  }];
    
  [subject sendNext:@1];
  [subject sendNext:@2];
  [subject sendNext:@3];
    
  // è¾“å‡º
  2017-01-03 17:35:54.566 ReactiveCocoaè¿›é˜¶[4969:1677908] 1
  2017-01-03 17:35:54.567 ReactiveCocoaè¿›é˜¶[4969:1677908] 2
</code></pre></div>    </div>
  </li>
</ul>

<h6 id="takelast">takeLast</h6>

<ul>
  <li>
    <p><strong>ä½œç”¨</strong></p>

    <p>å– <strong>æœ€åNæ¬¡</strong> çš„å‘é€çš„ä¿¡å·</p>

    <p>å‰ææ¡ä»¶ï¼Œè®¢é˜…è€…å¿…é¡»è°ƒç”¨å®Œæˆ <code class="language-plaintext highlighter-rouge">sendCompleted</code>ï¼Œå› ä¸ºåªæœ‰å®Œæˆï¼Œå°±çŸ¥é“æ€»å…±æœ‰å¤šå°‘ä¿¡å·.</p>
  </li>
  <li>
    <p><strong>ä½¿ç”¨</strong></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  RACSubject *subject = [RACSubject subject] ;
    
  // å– åä¸¤æ¬¡ å‘é€çš„ä¿¡å·
  [[subject takeLast:2] subscribeNext:^(id x) {
        
      NSLog(@"%@", x);
  }];
    
  [subject sendNext:@1];
  [subject sendNext:@2];
  [subject sendNext:@3];
    
  // å¿…é¡» è·³ç”¨å®Œæˆ
  [subject sendCompleted];
</code></pre></div>    </div>
  </li>
</ul>

<h6 id="takeuntil">takeUntil</h6>

<ul>
  <li>
    <p><strong>ä½œç”¨</strong></p>

    <p>è·å–ä¿¡å·ç›´åˆ°æŸä¸ªä¿¡å·æ‰§è¡Œå®Œæˆ</p>
  </li>
  <li>
    <p><strong>ä½¿ç”¨</strong></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  // ç›‘å¬æ–‡æœ¬æ¡†çš„æ”¹å˜ç›´åˆ°å½“å‰å¯¹è±¡è¢«é”€æ¯
[_textField.rac_textSignal takeUntil:self.rac_willDeallocSignal];
</code></pre></div>    </div>
  </li>
</ul>

<h6 id="switchtolatest">switchToLatest</h6>
<ul>
  <li>
    <p><strong>ä½œç”¨</strong></p>

    <p>ç”¨äºsignalOfSignalsï¼ˆä¿¡å·çš„ä¿¡å·ï¼‰ï¼Œæœ‰æ—¶å€™ä¿¡å·ä¹Ÿä¼šå‘å‡ºä¿¡å·ï¼Œä¼šåœ¨signalOfSignalsä¸­ï¼Œè·å–signalOfSignalså‘é€çš„æœ€æ–°ä¿¡å·ã€‚</p>
  </li>
  <li>
    <p><strong>æ³¨æ„</strong></p>

    <p>switchToLatestï¼šåªèƒ½ç”¨äºä¿¡å·ä¸­çš„ä¿¡å·</p>
  </li>
  <li>
    <p><strong>ä½¿ç”¨</strong></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  RACSubject *signalOfSignals = [RACSubject subject];
  RACSubject *signal = [RACSubject subject];
    
  // è·å–ä¿¡å·ä¸­ä¿¡å·æœ€è¿‘å‘å‡ºä¿¡å·ï¼Œè®¢é˜…æœ€è¿‘å‘å‡ºçš„ä¿¡å·ã€‚
  [signalOfSignals.switchToLatest subscribeNext:^(id x) {
        
      NSLog(@"%@", x);
  }];
    
  [signalOfSignals sendNext:signal];
  [signal sendNext:@1];
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="ç§©åº">ç§©åº</h4>

<p>ç§©åºåŒ…æ‹¬ <code class="language-plaintext highlighter-rouge">doNext</code> å’Œ <code class="language-plaintext highlighter-rouge">doCompleted</code> è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸»è¦æ˜¯åœ¨ æ‰§è¡Œ<code class="language-plaintext highlighter-rouge">sendNext</code> æˆ–è€… <code class="language-plaintext highlighter-rouge">sendCompleted</code>ä¹‹å‰ï¼Œå…ˆæ‰§è¡Œè¿™äº›æ–¹æ³•ä¸­Blockã€‚</p>

<h6 id="donext">doNext</h6>

<p>æ‰§è¡Œ<code class="language-plaintext highlighter-rouge">sendNext</code>ä¹‹å‰ï¼Œä¼šå…ˆæ‰§è¡Œè¿™ä¸ª<code class="language-plaintext highlighter-rouge">doNext</code>çš„ Block</p>

<h6 id="docompleted">doCompleted</h6>

<p>æ‰§è¡Œ<code class="language-plaintext highlighter-rouge">sendCompleted</code>ä¹‹å‰ï¼Œä¼šå…ˆæ‰§è¡Œè¿™<code class="language-plaintext highlighter-rouge">doCompleted</code>çš„<code class="language-plaintext highlighter-rouge">Block</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[[[[RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) {
    
    [subscriber sendNext:@"hi"];
    
    [subscriber sendCompleted];
    
    return nil;
    
}] doNext:^(id x) {
    
    // æ‰§è¡Œ [subscriber sendNext:@"hi"] ä¹‹å‰ä¼šè°ƒç”¨è¿™ä¸ª Block
    NSLog(@"doNext");
    
}] doCompleted:^{
    
    // æ‰§è¡Œ [subscriber sendCompleted] ä¹‹å‰ä¼šè°ƒç”¨è¿™ Block
    NSLog(@"doCompleted");
}] subscribeNext:^(id x) {
    
    NSLog(@"%@", x);
}];
    

</code></pre></div></div>

<h4 id="çº¿ç¨‹">çº¿ç¨‹</h4>

<p><strong>ReactiveCocoa</strong> ä¸­çš„çº¿ç¨‹æ“ä½œ åŒ…æ‹¬ <code class="language-plaintext highlighter-rouge">deliverOn</code> å’Œ <code class="language-plaintext highlighter-rouge">subscribeOn</code>è¿™ä¸¤ç§ï¼Œå°† <em>ä¼ é€’çš„å†…å®¹</em> æˆ– åˆ›å»ºä¿¡å·æ—¶ <em>blockä¸­çš„ä»£ç </em> åˆ‡æ¢åˆ°æŒ‡å®šçš„çº¿ç¨‹ä¸­æ‰§è¡Œã€‚</p>

<h6 id="deliveron">deliverOn</h6>

<ul>
  <li>
    <p><strong>ä½œç”¨</strong></p>

    <p>å†…å®¹ä¼ é€’åˆ‡æ¢åˆ°åˆ¶å®šçº¿ç¨‹ä¸­ï¼Œå‰¯ä½œç”¨åœ¨åŸæ¥çº¿ç¨‹ä¸­,æŠŠåœ¨åˆ›å»ºä¿¡å·æ—¶blockä¸­çš„ä»£ç ç§°ä¹‹ä¸ºå‰¯ä½œç”¨ã€‚</p>
  </li>
  <li>
    <p><strong>ä½¿ç”¨</strong></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  // åœ¨å­çº¿ç¨‹ä¸­æ‰§è¡Œ
  dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
        
      [[[RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) {
        
          NSLog(@"%@", [NSThread currentThread]);
            
          [subscriber sendNext:@123];
            
          [subscriber sendCompleted];
            
          return nil;
      }]
        deliverOn:[RACScheduler mainThreadScheduler]]
          
       subscribeNext:^(id x) {
         
           NSLog(@"%@", x);
             
           NSLog(@"%@", [NSThread currentThread]);
       }];
  });
    
  // è¾“å‡º
2017-01-04 10:35:55.415 ReactiveCocoaè¿›é˜¶[1183:224535] &lt;NSThread: 0x608000270f00&gt;{number = 3, name = (null)}
2017-01-04 10:35:55.415 ReactiveCocoaè¿›é˜¶[1183:224482] 123
2017-01-04 10:35:55.415 ReactiveCocoaè¿›é˜¶[1183:224482] &lt;NSThread: 0x600000079bc0&gt;{number = 1, name = main}
</code></pre></div>    </div>

    <p>å¯ä»¥çœ‹åˆ°<code class="language-plaintext highlighter-rouge">å‰¯ä½œç”¨</code>åœ¨ <em>å­çº¿ç¨‹</em> ä¸­æ‰§è¡Œï¼Œè€Œ <code class="language-plaintext highlighter-rouge">ä¼ é€’çš„å†…å®¹</code> åœ¨ <em>ä¸»çº¿ç¨‹</em> ä¸­æ¥æ”¶</p>
  </li>
</ul>

<h6 id="subscribeon">subscribeOn</h6>
<ul>
  <li>
    <p><strong>ä½œç”¨</strong></p>

    <p><strong>subscribeOn</strong>åˆ™æ˜¯å°† <code class="language-plaintext highlighter-rouge">å†…å®¹ä¼ é€’</code> å’Œ <code class="language-plaintext highlighter-rouge">å‰¯ä½œç”¨</code> éƒ½ä¼šåˆ‡æ¢åˆ°æŒ‡å®šçº¿ç¨‹ä¸­</p>
  </li>
  <li>
    <p><strong>ä½¿ç”¨</strong></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
        
      [[[RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) {
        
          NSLog(@"%@", [NSThread currentThread]);
            
          [subscriber sendNext:@123];
            
          [subscriber sendCompleted];
            
          return nil;
      }]
        subscribeOn:[RACScheduler mainThreadScheduler]] //ä¼ é€’çš„å†…å®¹åˆ°ä¸»çº¿ç¨‹ä¸­
       subscribeNext:^(id x) {
         
           NSLog(@"%@", x);
             
           NSLog(@"%@", [NSThread currentThread]);
       }];
  });	
  //
2017-01-04 10:44:47.558 ReactiveCocoaè¿›é˜¶[1243:275126] &lt;NSThread: 0x608000077640&gt;{number = 1, name = main}
2017-01-04 10:44:47.558 ReactiveCocoaè¿›é˜¶[1243:275126] 123
2017-01-04 10:44:47.558 ReactiveCocoaè¿›é˜¶[1243:275126] &lt;NSThread: 0x608000077640&gt;{number = 1, name = main}
</code></pre></div>    </div>

    <p><code class="language-plaintext highlighter-rouge">å†…å®¹ä¼ é€’</code> å’Œ <code class="language-plaintext highlighter-rouge">å‰¯ä½œç”¨</code> éƒ½åˆ‡æ¢åˆ°äº† <em>ä¸»çº¿ç¨‹</em> æ‰§è¡Œ</p>
  </li>
</ul>

<h4 id="æ—¶é—´">æ—¶é—´</h4>

<p>æ—¶é—´æ“ä½œå°±ä¼šè®¾ç½®ä¿¡å·è¶…æ—¶ï¼Œå®šæ—¶å’Œå»¶æ—¶ã€‚</p>

<h6 id="interval-å®šæ—¶">interval å®šæ—¶</h6>
<ul>
  <li>
    <p><strong>ä½œç”¨</strong></p>

    <p>å®šæ—¶ï¼šæ¯éš”ä¸€æ®µæ—¶é—´å‘å‡ºä¿¡å·</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  // æ¯éš”1ç§’å‘é€ä¿¡å·ï¼ŒæŒ‡å®šå½“å‰çº¿ç¨‹æ‰§è¡Œ
  [[RACSignal interval:1 onScheduler:[RACScheduler currentScheduler]] subscribeNext:^(id x) {
        
      NSLog(@"å®šæ—¶:%@", x);
  }];
    
  // è¾“å‡º
  2017-01-04 13:48:55.196 ReactiveCocoaè¿›é˜¶[1980:492724] å®šæ—¶:2017-01-04 05:48:55 +0000
  2017-01-04 13:48:56.195 ReactiveCocoaè¿›é˜¶[1980:492724] å®šæ—¶:2017-01-04 05:48:56 +0000
  2017-01-04 13:48:57.196 ReactiveCocoaè¿›é˜¶[1980:492724] å®šæ—¶:2017-01-04 05:48:57 +0000
</code></pre></div>    </div>
  </li>
</ul>

<h6 id="timeout-è¶…æ—¶">timeout è¶…æ—¶</h6>

<ul>
  <li>
    <p><strong>ä½œç”¨</strong></p>

    <p>è¶…æ—¶ï¼Œå¯ä»¥è®©ä¸€ä¸ªä¿¡å·åœ¨ä¸€å®šçš„æ—¶é—´åï¼Œè‡ªåŠ¨æŠ¥é”™ã€‚</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  RACSignal *signal = [[RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) {
        
      // ä¸å‘é€ä¿¡å·ï¼Œæ¨¡æ‹Ÿè¶…æ—¶çŠ¶æ€
      // [subscriber sendNext:@"hello"];
      //[subscriber sendCompleted];
        
      return nil;
  }] timeout:1 onScheduler:[RACScheduler currentScheduler]];// è®¾ç½®1ç§’è¶…æ—¶
    
  [signal subscribeNext:^(id x) {
        
      NSLog(@"%@", x);
  } error:^(NSError *error) {
        
      NSLog(@"%@", error);
  }];
    
  // æ‰§è¡Œä»£ç  1ç§’å è¾“å‡ºï¼š
  2017-01-04 13:48:55.195 ReactiveCocoaè¿›é˜¶[1980:492724] Error Domain=RACSignalErrorDomain Code=1 "(null)"
</code></pre></div>    </div>
  </li>
</ul>

<h6 id="delay-å»¶æ—¶">delay å»¶æ—¶</h6>
<ul>
  <li>
    <p><strong>ä½œç”¨</strong></p>

    <p>å»¶æ—¶ï¼Œå»¶è¿Ÿä¸€æ®µæ—¶é—´åå‘é€ä¿¡å·</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  RACSignal *signal2 = [[[RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) {
        
      [subscriber sendNext:@"å»¶è¿Ÿè¾“å‡º"];
        
      return nil;
  }] delay:2] subscribeNext:^(id x) {
        
      NSLog(@"%@", x);
  }];
    
  // æ‰§è¡Œä»£ç  2ç§’å è¾“å‡º
  2017-01-04 13:55:23.751 ReactiveCocoaè¿›é˜¶[2030:525038] å»¶è¿Ÿè¾“å‡º
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="é‡å¤">é‡å¤</h4>

<h6 id="retry">retry</h6>

<ul>
  <li>
    <p><strong>ä½œç”¨</strong></p>

    <p>é‡è¯•ï¼šåªè¦ å‘é€é”™è¯¯ <code class="language-plaintext highlighter-rouge">sendError:</code>,å°±ä¼š é‡æ–°æ‰§è¡Œ åˆ›å»ºä¿¡å·çš„Block ç›´åˆ°æˆåŠŸ</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  __block int i = 0;
    
  [[[RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) {
        
      if (i == 5) {
            
          [subscriber sendNext:@"Hello"];
            
      } else {
            
          // å‘é€é”™è¯¯
          NSLog(@"æ”¶åˆ°é”™è¯¯:%d", i);
          [subscriber sendError:nil];
      }
        
      i++;
        
      return nil;
        
  }] retry] subscribeNext:^(id x) {
        
      NSLog(@"%@", x);
        
  } error:^(NSError *error) {
        
      NSLog(@"%@", error);
        
  }];

  // è¾“å‡º
2017-01-04 14:36:51.594 ReactiveCocoaè¿›é˜¶[2443:667226] æ”¶åˆ°é”™è¯¯ä¿¡æ¯:0
2017-01-04 14:36:51.595 ReactiveCocoaè¿›é˜¶[2443:667226] æ”¶åˆ°é”™è¯¯ä¿¡æ¯:1
2017-01-04 14:36:51.595 ReactiveCocoaè¿›é˜¶[2443:667226] æ”¶åˆ°é”™è¯¯ä¿¡æ¯:2
2017-01-04 14:36:51.596 ReactiveCocoaè¿›é˜¶[2443:667226] æ”¶åˆ°é”™è¯¯ä¿¡æ¯:3
2017-01-04 14:36:51.596 ReactiveCocoaè¿›é˜¶[2443:667226] æ”¶åˆ°é”™è¯¯ä¿¡æ¯:4
2017-01-04 14:36:51.596 ReactiveCocoaè¿›é˜¶[2443:667226] Hello

</code></pre></div>    </div>
  </li>
</ul>

<h6 id="replay">replay</h6>

<ul>
  <li>
    <p><strong>ä½œç”¨</strong></p>

    <p>é‡æ”¾ï¼šå½“ä¸€ä¸ªä¿¡å·è¢«å¤šæ¬¡è®¢é˜…,åå¤æ’­æ”¾å†…å®¹</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  RACSignal *signal = [[RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) {
        
      [subscriber sendNext:@1];
      [subscriber sendNext:@2];
        
      return nil;
  }] replay];
    
  [signal subscribeNext:^(id x) {
      NSLog(@"%@", x);
  }];
    
  [signal subscribeNext:^(id x) {
      NSLog(@"%@", x);
  }];
    
  // è¾“å‡º
2017-01-04 14:51:01.934 ReactiveCocoaè¿›é˜¶[2544:706740] 1
2017-01-04 14:51:01.934 ReactiveCocoaè¿›é˜¶[2544:706740] 2
2017-01-04 14:51:01.934 ReactiveCocoaè¿›é˜¶[2544:706740] 1
2017-01-04 14:51:01.935 ReactiveCocoaè¿›é˜¶[2544:706740] 2
</code></pre></div>    </div>
  </li>
</ul>

<h6 id="throttle">throttle</h6>

<ul>
  <li>
    <p><strong>ä½œç”¨</strong></p>

    <p>èŠ‚æµ:å½“æŸä¸ªä¿¡å·å‘é€æ¯”è¾ƒé¢‘ç¹æ—¶ï¼Œå¯ä»¥ä½¿ç”¨èŠ‚æµï¼Œåœ¨æŸä¸€æ®µæ—¶é—´ä¸å‘é€ä¿¡å·å†…å®¹ï¼Œè¿‡äº†ä¸€æ®µæ—¶é—´è·å–ä¿¡å·çš„æœ€æ–°å†…å®¹å‘å‡ºã€‚</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  RACSubject *subject = [RACSubject subject];
    
  // èŠ‚æµ1ç§’ï¼Œ1ç§’åæ¥æ”¶æœ€åä¸€ä¸ªå‘é€çš„ä¿¡å·
  [[subject throttle:1] subscribeNext:^(id x) {
        
      NSLog(@"%@", x);
  }];
    
  [subject sendNext:@1];
  [subject sendNext:@2];
  [subject sendNext:@3];
    
  // è¾“å‡º
  2017-01-04 15:02:37.543 ReactiveCocoaè¿›é˜¶[2731:758193] 3
</code></pre></div>    </div>
  </li>
</ul>

<h1 id="mvvmæ¶æ„æ€æƒ³">MVVMæ¶æ„æ€æƒ³</h1>
<hr />
<p>ç¨‹åºä¸ºä»€ä¹ˆè¦æœ‰æ¶æ„ï¼Ÿä¾¿äºç¨‹åºå¼€å‘ä¸ç»´æŠ¤.</p>

<h4 id="å¸¸è§çš„æ¶æ„">å¸¸è§çš„æ¶æ„</h4>
<ul>
  <li>
    <p><strong>MVC</strong></p>

    <p>M:æ¨¡å‹ V:è§†å›¾ C:æ§åˆ¶å™¨</p>
  </li>
  <li>
    <p><strong>MVVM</strong></p>

    <p>M:æ¨¡å‹ V:è§†å›¾+æ§åˆ¶å™¨ VM:è§†å›¾æ¨¡å‹</p>
  </li>
  <li>
    <p><strong>MVCS</strong></p>

    <p>M:æ¨¡å‹ V:è§†å›¾ C:æ§åˆ¶å™¨ C:æœåŠ¡ç±»</p>
  </li>
  <li>
    <p><a href="http://www.cocoachina.com/ios/20140703/9016.html"><strong>VIPER</strong></a></p>

    <p>V:è§†å›¾ I:äº¤äº’å™¨ P:å±•ç¤ºå™¨ E:å®ä½“ R:è·¯ç”±</p>
  </li>
</ul>

<h4 id="mvvmä»‹ç»">MVVMä»‹ç»</h4>

<ul>
  <li>
    <p>æ¨¡å‹(M):ä¿å­˜è§†å›¾æ•°æ®ã€‚</p>
  </li>
  <li>
    <p>è§†å›¾+æ§åˆ¶å™¨(V):å±•ç¤ºå†…å®¹ + å¦‚ä½•å±•ç¤º</p>
  </li>
  <li>
    <p>è§†å›¾æ¨¡å‹(VM):å¤„ç†å±•ç¤ºçš„ä¸šåŠ¡é€»è¾‘ï¼ŒåŒ…æ‹¬æŒ‰é’®çš„ç‚¹å‡»ï¼Œæ•°æ®çš„è¯·æ±‚å’Œè§£æç­‰ç­‰ã€‚</p>
  </li>
</ul>

<h1 id="å®æˆ˜ä¸€ç™»å½•ç•Œé¢">å®æˆ˜ä¸€ï¼šç™»å½•ç•Œé¢</h1>

<h4 id="éœ€æ±‚">éœ€æ±‚</h4>
<ol>
  <li>ç›‘å¬ä¸¤ä¸ªæ–‡æœ¬æ¡†çš„å†…å®¹</li>
  <li>æœ‰å†…å®¹ç™»å½•æŒ‰é”®æ‰å…è®¸æŒ‰é’®ç‚¹å‡»</li>
  <li>è¿”å›ç™»å½•ç»“æœ</li>
</ol>

<h4 id="åˆ†æ">åˆ†æ</h4>
<ol>
  <li>ç•Œé¢çš„æ‰€æœ‰ä¸šåŠ¡é€»è¾‘éƒ½äº¤ç»™æ§åˆ¶å™¨åšå¤„ç†</li>
  <li>åœ¨MVVMæ¶æ„ä¸­æŠŠæ§åˆ¶å™¨çš„ä¸šåŠ¡å…¨éƒ¨æ¬å»VMæ¨¡å‹ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªæ§åˆ¶å™¨å¯¹åº”ä¸€ä¸ªVMæ¨¡å‹.</li>
</ol>

<h4 id="æ­¥éª¤">æ­¥éª¤</h4>
<ol>
  <li>åˆ›å»ºLoginViewModelç±»ï¼Œå¤„ç†ç™»å½•ç•Œé¢ä¸šåŠ¡é€»è¾‘.</li>
  <li>è¿™ä¸ªç±»é‡Œé¢åº”è¯¥ä¿å­˜ç€è´¦å·çš„ä¿¡æ¯ï¼Œåˆ›å»ºä¸€ä¸ªè´¦å·Accountæ¨¡å‹</li>
  <li>LoginViewModelåº”è¯¥ä¿å­˜ç€è´¦å·ä¿¡æ¯Accountæ¨¡å‹ã€‚</li>
  <li>éœ€è¦æ—¶åˆ»ç›‘å¬Accountæ¨¡å‹ä¸­çš„è´¦å·å’Œå¯†ç çš„æ”¹å˜ï¼Œæ€ä¹ˆç›‘å¬ï¼Ÿ</li>
  <li>åœ¨éRACå¼€å‘ä¸­ï¼Œéƒ½æ˜¯ä¹ æƒ¯èµ‹å€¼ï¼Œåœ¨RACå¼€å‘ä¸­ï¼Œéœ€è¦æ”¹å˜å¼€å‘æ€ç»´ï¼Œç”±èµ‹å€¼è½¬å˜ä¸ºç»‘å®šï¼Œå¯ä»¥åœ¨ä¸€å¼€å§‹åˆå§‹åŒ–çš„æ—¶å€™ï¼Œå°±ç»™Accountæ¨¡å‹ä¸­çš„å±æ€§ç»‘å®šï¼Œå¹¶ä¸éœ€è¦é‡å†™setæ–¹æ³•ã€‚</li>
  <li>æ¯æ¬¡Accountæ¨¡å‹çš„å€¼æ”¹å˜ï¼Œå°±éœ€è¦åˆ¤æ–­æŒ‰é’®èƒ½å¦ç‚¹å‡»ï¼Œåœ¨VMæ¨¡å‹ä¸­åšå¤„ç†ï¼Œç»™å¤–ç•Œæä¾›ä¸€ä¸ªèƒ½å¦ç‚¹å‡»æŒ‰é’®çš„ä¿¡å·.</li>
  <li>è¿™ä¸ªç™»å½•ä¿¡å·éœ€è¦åˆ¤æ–­Accountä¸­è´¦å·å’Œå¯†ç æ˜¯å¦æœ‰å€¼ï¼Œç”¨KVOç›‘å¬è¿™ä¸¤ä¸ªå€¼çš„æ”¹å˜ï¼ŒæŠŠä»–ä»¬èšåˆæˆç™»å½•ä¿¡å·.</li>
  <li>ç›‘å¬æŒ‰é’®çš„ç‚¹å‡»ï¼Œç”±VMå¤„ç†ï¼Œåº”è¯¥ç»™VMå£°æ˜ä¸€ä¸ªRACCommandï¼Œä¸“é—¨å¤„ç†ç™»å½•ä¸šåŠ¡é€»è¾‘.</li>
  <li>æ‰§è¡Œå‘½ä»¤ï¼ŒæŠŠæ•°æ®åŒ…è£…æˆä¿¡å·ä¼ é€’å‡ºå»</li>
  <li>ç›‘å¬å‘½ä»¤ä¸­ä¿¡å·çš„æ•°æ®ä¼ é€’</li>
  <li>ç›‘å¬å‘½ä»¤çš„æ‰§è¡Œæ—¶åˆ»</li>
</ol>

<h4 id="è¿è¡Œæ•ˆæœ">è¿è¡Œæ•ˆæœ</h4>

<p><img src="https://ww3.sinaimg.cn/large/006y8lVagw1fbgvoh8yu6j30bj0l43yz.jpg" alt="ç™»å½•ç•Œé¢" /></p>

<h4 id="ä»£ç ">ä»£ç </h4>

<p><code class="language-plaintext highlighter-rouge">MyViewController.m</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#import "MyViewController.h"
#import "LoginViewModel.h"

@interface MyViewController ()

@property (nonatomic, strong) LoginViewModel *loginViewModel;

@property (weak, nonatomic) IBOutlet UITextField *accountField;

@property (weak, nonatomic) IBOutlet UITextField *pwdField;

@property (weak, nonatomic) IBOutlet UIButton *loginBtn;

@end

@implementation MyViewController

- (void)viewDidLoad {
    [super viewDidLoad];
    
    [self bindModel];
    
}

- (void)didReceiveMemoryWarning {
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}



// è§†å›¾æ¨¡å‹ç»‘å®š
- (void)bindModel {

    // ç»™æ¨¡å‹çš„å±æ€§ç»‘å®šä¿¡å·
    //
    RAC(self.loginViewModel.account, account) = _accountField.rac_textSignal;
    RAC(self.loginViewModel.account, pwd) = _pwdField.rac_textSignal;
    
    RAC(self.loginBtn, enabled) = self.loginViewModel.enableLoginSignal;
    
    // ç›‘å¬ç™»å½•ç‚¹å‡»
    [[_loginBtn rac_signalForControlEvents:UIControlEventTouchUpInside] subscribeNext:^(id x) {
        
        [self.loginViewModel.LoginCommand execute:nil];
    }];
    
}
- (IBAction)btnTap:(id)sender {
    
    
}

#pragma mark - lazyLoad

- (LoginViewModel *)loginViewModel {
    
    if (nil == _loginViewModel) {
        _loginViewModel = [[LoginViewModel alloc] init];
    }
    
    return _loginViewModel;
}
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">LoginViewModel.h</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#import &lt;UIKit/UIKit.h&gt;

@interface Account : NSObject

@property (nonatomic, strong) NSString *account;
@property (nonatomic, strong) NSString *pwd;

@end


@interface LoginViewModel : UIViewController

@property (nonatomic, strong) Account *account;

// æ˜¯å¦å…è®¸ç™»å½•çš„ä¿¡å·
@property (nonatomic, strong, readonly) RACSignal *enableLoginSignal;

@property (nonatomic, strong, readonly) RACCommand *LoginCommand;

@end

</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">LoginViewModel.m</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#import "LoginViewModel.h"

@implementation Account

@end


@interface LoginViewModel ()

@end

@implementation LoginViewModel

- (instancetype)init {
    
    if (self = [super init]) {
        [self initialBind];
    }
    return self;
}

- (void)initialBind {

    // ç›‘å¬è´¦å·å±æ€§æ”¹å˜ï¼Œ æŠŠä»–ä»¬åˆæˆä¸€ä¸ªä¿¡å·
    _enableLoginSignal = [RACSubject combineLatest:@[RACObserve(self.account, account), RACObserve(self.account, pwd)] reduce:^id(NSString *accout, NSString *pwd){
        
        return @(accout.length &amp;&amp; pwd.length);
    }];
    
    // å¤„ç†ä¸šåŠ¡é€»è¾‘
    _LoginCommand = [[RACCommand alloc] initWithSignalBlock:^RACSignal *(id input) {
        
        NSLog(@"ç‚¹å‡»äº†ç™»å½•");
        return [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) {
            
            // æ¨¡ä»¿ç½‘ç»œå»¶è¿Ÿ

            dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(0.5 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^{
                
                // è¿”å›ç™»å½•æˆåŠŸ å‘é€æˆåŠŸä¿¡å·
                [subscriber sendNext:@"ç™»å½•æˆåŠŸ"];
            });
            
            return nil;
        }];
    }];
    
    
    // ç›‘å¬ç™»å½•äº§ç”Ÿçš„æ•°æ®
    [_LoginCommand.executionSignals.switchToLatest subscribeNext:^(id x) {
       
        if ([x isEqualToString:@"ç™»å½•æˆåŠŸ"]) {
            NSLog(@"ç™»å½•æˆåŠŸ");
        }
        
    }];
    
    [[_LoginCommand.executing skip:1] subscribeNext:^(id x) {
        
        if ([x isEqualToNumber:@(YES)]) {
            
            NSLog(@"æ­£åœ¨ç™»é™†...");
        } else {
            
        // ç™»å½•æˆåŠŸ
        NSLog(@"ç™»é™†æˆåŠŸ");
        
        }
        
    }];
}

#pragma mark - lazyLoad

- (Account *)account
{
    if (_account == nil) {
        _account = [[Account alloc] init];
    }
    return _account;
}

- (void)viewDidLoad {
    [super viewDidLoad];
    
}

@end

</code></pre></div></div>

<h1 id="å®æˆ˜äºŒç½‘ç»œè¯·æ±‚æ•°æ®">å®æˆ˜äºŒï¼šç½‘ç»œè¯·æ±‚æ•°æ®</h1>

<h4 id="éœ€æ±‚-1">éœ€æ±‚</h4>
<ol>
  <li>è¯·æ±‚ä¸€æ®µç½‘ç»œæ•°æ®ï¼Œå°†è¯·æ±‚åˆ°çš„æ•°æ®åœ¨<code class="language-plaintext highlighter-rouge">tableView</code>ä¸Šå±•ç¤º</li>
  <li>è¯¥æ•°æ®ä¸ºè±†ç“£å›¾ä¹¦çš„æœç´¢è¿”å›ç»“æœï¼ŒURLï¼šurl:https://api.douban.com/v2/book/search?q=æ‚Ÿç©ºä¼ </li>
</ol>

<h4 id="åˆ†æ-1">åˆ†æ</h4>
<ol>
  <li>ç•Œé¢çš„æ‰€æœ‰ä¸šåŠ¡é€»è¾‘éƒ½äº¤ç»™<strong>æ§åˆ¶å™¨</strong>åšå¤„ç†</li>
  <li>ç½‘ç»œè¯·æ±‚äº¤ç»™<strong>MV</strong>æ¨¡å‹å¤„ç†</li>
</ol>

<h4 id="æ­¥éª¤-1">æ­¥éª¤</h4>

<ol>
  <li>æ§åˆ¶å™¨æä¾›ä¸€ä¸ªè§†å›¾æ¨¡å‹ï¼ˆrequesViewModelï¼‰ï¼Œå¤„ç†ç•Œé¢çš„ä¸šåŠ¡é€»è¾‘</li>
  <li>VMæä¾›ä¸€ä¸ªå‘½ä»¤ï¼Œå¤„ç†è¯·æ±‚ä¸šåŠ¡é€»è¾‘</li>
  <li>åœ¨åˆ›å»ºå‘½ä»¤çš„blockä¸­ï¼Œä¼šæŠŠè¯·æ±‚åŒ…è£…æˆä¸€ä¸ªä¿¡å·ï¼Œç­‰è¯·æ±‚æˆåŠŸçš„æ—¶å€™ï¼Œå°±ä¼šæŠŠæ•°æ®ä¼ é€’å‡ºå»ã€‚</li>
  <li>è¯·æ±‚æ•°æ®æˆåŠŸï¼Œåº”è¯¥æŠŠå­—å…¸è½¬æ¢æˆæ¨¡å‹ï¼Œä¿å­˜åˆ°è§†å›¾æ¨¡å‹ä¸­ï¼Œæ§åˆ¶å™¨æƒ³ç”¨å°±ç›´æ¥ä»è§†å›¾æ¨¡å‹ä¸­è·å–ã€‚</li>
</ol>

<h4 id="å…¶ä»–">å…¶ä»–</h4>

<p>ç½‘ç»œè¯·æ±‚ä¸å›¾ç‰‡ç¼“å­˜ç”¨åˆ°äº†<a href="https://github.com/AFNetworking/AFNetworking">AFNetworking</a> å’Œ <a href="https://github.com/rs/SDWebImage">SDWebImage</a>,è‡ªè¡Œåœ¨Podsä¸­å¯¼å…¥ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>platform :ios, '8.0'

target 'ReactiveCocoaè¿›é˜¶' do

use_frameworks!
pod 'ReactiveCocoa', '~&gt; 2.5'
pod 'AFNetworking'
pod 'SDWebImage'
end
</code></pre></div></div>

<h4 id="è¿è¡Œæ•ˆæœ-1">è¿è¡Œæ•ˆæœ</h4>

<p><img src="https://ww3.sinaimg.cn/large/006y8lVagw1fbgw1xnz74j30bj0l4408.jpg" alt="" /></p>

<h4 id="ä»£ç -1">ä»£ç </h4>

<p><code class="language-plaintext highlighter-rouge">SearchViewController.m</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#import "SearchViewController.h"
#import "RequestViewModel.h"

@interface SearchViewController ()&lt;UITableViewDataSource&gt;

@property (nonatomic, strong) UITableView *tableView;

@property (nonatomic, strong) RequestViewModel *requesViewModel;

@end

@implementation SearchViewController

- (RequestViewModel *)requesViewModel
{
    if (_requesViewModel == nil) {
        _requesViewModel = [[RequestViewModel alloc] init];
    }
    return _requesViewModel;
}

- (void)viewDidLoad {
    [super viewDidLoad];
    
    
    self.tableView = [[UITableView alloc] initWithFrame:self.view.frame];
    
    self.tableView.dataSource = self;
    
    [self.view addSubview:self.tableView];
    
    //
    RACSignal *requesSiganl = [self.requesViewModel.reuqesCommand execute:nil];
    
    [requesSiganl subscribeNext:^(NSArray *x) {
        
        self.requesViewModel.models = x;
        
        [self.tableView reloadData];
    }];
}

- (void)didReceiveMemoryWarning {
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return self.requesViewModel.models.count;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *ID = @"cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:ID];
    if (cell == nil) {
        
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:ID];
    }
    
    Book *book = self.requesViewModel.models[indexPath.row];
    cell.detailTextLabel.text = book.subtitle;
    cell.textLabel.text = book.title;
    
    [cell.imageView sd_setImageWithURL:[NSURL URLWithString:book.image] placeholderImage:[UIImage imageNamed:@"cellImage"]];
    
    
    return cell;
}
@end
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">RequestViewModel.h</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#import &lt;Foundation/Foundation.h&gt;

@interface Book : NSObject

@property (nonatomic, copy) NSString *subtitle;
@property (nonatomic, copy) NSString *title;
@property (nonatomic, copy) NSString *image;

@end

@interface RequestViewModel : NSObject

// è¯·æ±‚å‘½ä»¤
@property (nonatomic, strong, readonly) RACCommand *reuqesCommand;

//æ¨¡å‹æ•°ç»„
@property (nonatomic, strong) NSArray *models;


@end
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">RequestViewModel.m</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#import "RequestViewModel.h"

@implementation Book

- (instancetype)initWithValue:(NSDictionary *)value {
    
    if (self = [super init]) {
        
        self.title = value[@"title"];
        self.subtitle = value[@"subtitle"];
        self.image = value[@"image"];
    }
    return self;
}

+ (Book *)bookWithDict:(NSDictionary *)value {
    
    return [[self alloc] initWithValue:value];
}



@end

@implementation RequestViewModel

- (instancetype)init
{
    if (self = [super init]) {
        
        [self initialBind];
    }
    return self;
}


- (void)initialBind
{
    _reuqesCommand = [[RACCommand alloc] initWithSignalBlock:^RACSignal *(id input) {
        
      RACSignal *requestSiganl = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) {
          
          NSMutableDictionary *parameters = [NSMutableDictionary dictionary];
          parameters[@"q"] = @"æ‚Ÿç©ºä¼ ";
          
          //
          [[AFHTTPSessionManager manager] GET:@"https://api.douban.com/v2/book/search" parameters:parameters progress:^(NSProgress * _Nonnull downloadProgress) {
              
              NSLog(@"downloadProgress: %@", downloadProgress);
          } success:^(NSURLSessionDataTask * _Nonnull task, id  _Nullable responseObject) {
              
              // æ•°æ®è¯·æ±‚æˆåŠŸå°±è®²æ•°æ®å‘é€å‡ºå»
              NSLog(@"responseObject:%@", responseObject);
              
              [subscriber sendNext:responseObject];
              
              [subscriber sendCompleted];
              
          } failure:^(NSURLSessionDataTask * _Nullable task, NSError * _Nonnull error) {
              
              NSLog(@"error: %@", error);
          }];
          
          
         return nil;
      }];
        
        // åœ¨è¿”å›æ•°æ®ä¿¡å·æ—¶ï¼ŒæŠŠæ•°æ®ä¸­çš„å­—å…¸æ˜ å°„æˆæ¨¡å‹ä¿¡å·ï¼Œä¼ é€’å‡ºå»
        return [requestSiganl map:^id(NSDictionary *value) {
            
            NSMutableArray *dictArr = value[@"books"];
            
            NSArray *modelArr = [[dictArr.rac_sequence map:^id(id value) {
                
                return [Book bookWithDict:value];
                
            }] array];
            
            return modelArr;
            
        }];
        
    }];
}


@end

</code></pre></div></div>

<blockquote>
  <p>æœ€åé™„ä¸ŠGitHubï¼š<a href="https://github.com/qiubaiying/ReactiveCocoa_Demo">https://github.com/qiubaiying/ReactiveCocoa_Demo</a></p>
</blockquote>
:ET