---
layout: post
title: Redisç¼“å­˜å‡»ç©¿
subtitle: ğŸ˜
date: 2019-07-19
author: åä»”
header-img: img/post-bg-debug.png
catalog: false
tags:
    - Redis
---

## *ç¼“å­˜ç©¿é€ã€ç¼“å­˜é›ªå´©å’Œç¼“å­˜å‡»ç©¿*

### ç¼“å­˜ç©¿é€

ç¼“å­˜ç©¿é€æŒ‡çš„æ˜¯æŸ¥è¯¢ä¸€ä¸ªåœ¨æ•°æ®åº“ä¸­ä¸å­˜åœ¨çš„å¯¹è±¡ï¼Œè€Œåˆæ²¡æœ‰ç¼“å­˜è¿™ä¸ªkeyå¯¼è‡´è¯·æ±‚éƒ½ä¼šæŸ¥è¯¢redisåæŸ¥è¯¢æ•°æ®åº“

**ä¼ªä»£ç ï¼š**

```
public Object queryObjectByKey(String key) {
	Object obj = redisTemplate.opsForValue().get(key);
	if(null != obj) {
		//æœ‰ç¼“å­˜æ•°æ® ç›´æ¥è¿”å›
		return obj;
	}
	//æ²¡æœ‰ç¼“å­˜ æŸ¥è¯¢æ•°æ®åº“
	Object result = mapper.selectByKey(key);
	if(null != result) {
		//å¦‚æœæ•°æ®åº“ä¸­æŸ¥è¯¢çš„å†…å®¹ä¸ä¸ºç©ºå°±å­˜å…¥ç¼“å­˜
		redisTemplate.opsForValue().set(key,result,60,TimeUtil.MINUTES);
	}
	//è¿”å›ç»“æœ
	return result;
}
```

ä½†æ˜¯å¦‚æœä¼ å…¥çš„è¿™ä¸ªkeyåœ¨æ•°æ®åº“ä¸­å°±ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆåœ¨ç¼“å­˜ä¸­ä¹Ÿä¸ä¼šå­˜åœ¨ï¼Œé‚£ä¹ˆå°±å¯ä»¥é‡å¤è®¿é—®è¿›è¡Œæ”»å‡»ï¼Œæ¯ä¸€æ¬¡è¯·æ±‚éƒ½ä¼šè¿›è¡ŒæŸ¥åº“ã€‚

**è§£å†³æ–¹æ¡ˆï¼š**
å¯ä»¥åœ¨æŸ¥è¯¢åˆ°çš„å¯¹è±¡ä¸ºç©ºçš„æƒ…å†µä¸‹ä¹Ÿè¿›è¡Œç¼“å­˜ï¼Œåªä¸è¿‡è®¾ç½®è¾ƒä½çš„ç¼“å­˜è¿‡æœŸæ—¶é—´

---

### ç¼“å­˜é›ªå´©

**é—®é¢˜åŸå› ï¼š**
åœ¨å¾ˆçŸ­çš„æ—¶é—´å†…å¯¹å¤§é‡æ•°æ®è¿›è¡Œç¼“å­˜ï¼Œå¹¶ä¸”ç¼“å­˜è¿‡æœŸæ—¶é—´ä¸€è‡´ï¼Œå¯¼è‡´å¤§æ‰¹é‡ç¼“å­˜åœ¨çŸ­æ—¶é—´å†…è¿‡æœŸå¯¹æ•°æ®åº“é€ æˆå¾ˆå¤§çš„å‹åŠ›ã€‚

**è§£å†³æ–¹æ¡ˆï¼š**
å¯ä»¥åŒºåˆ†å¾ˆç«çˆ†çš„æ•°æ®å’Œåå†·çš„æ•°æ®è®¾ç½®ä¸åŒçš„ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼Œå¹¶è®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´æ—¶åŠ ä¸Šéšæœºå› å­ï¼Œè¿™æ ·å°½å¯èƒ½çš„åˆ†æ•£ç¼“å­˜è¿‡æœŸæ—¶é—´ã€‚

---

### ç¼“å­˜å‡»ç©¿

ç¼“å­˜å‡»ç©¿æŒ‡çš„æ˜¯å½“ä¸€ä¸ªkeyéå¸¸çƒ­ç‚¹ï¼Œåœ¨ä¸åœçš„æ‰›ç€å¤§å¹¶å‘ï¼Œå¤§å¹¶å‘é›†ä¸­å¯¹è¿™ä¸€ä¸ªç‚¹è¿›è¡Œè®¿é—®ï¼Œå½“è¿™ä¸ªkeyåœ¨å¤±æ•ˆçš„ç¬é—´ï¼ŒæŒç»­çš„å¤§å¹¶å‘å°±å‡»ç©¿äº†ç¼“å­˜ï¼Œç›´æ¥è¯·æ±‚æ•°æ®åº“ï¼Œç»™æ•°æ®åº“å¸¦æ¥ä¸å¯é¢„çŸ¥çš„å‹åŠ›ï¼Œå¾ˆæœ‰å¯èƒ½ç¬é—´å°±æŠŠæ•°æ®åº“å‹å®ã€‚

**è§£å†³æ–¹æ¡ˆä¸€ï¼š**
æœ€ç®€å•çš„æ–¹å¼å°±æ˜¯å°†çƒ­ç‚¹keyçš„ç¼“å­˜æ—¶é—´è®¾ç½®çš„ç‰¹åˆ«é•¿æˆ–è€…ä¸´æ—¶è®¾ç½®ä¸ºæ°¸ä¸è¿‡æœŸkeyã€‚
ç¼ºç‚¹ï¼šè¿™ä¸ªvalueç›¸å½“äºæ˜¯é™æ€çš„ï¼Œä¸€ç›´ä¸ä¼šæ”¹å˜

**è§£å†³æ–¹æ¡ˆäºŒï¼šï¼ˆä¼˜ï¼‰**
ä¼˜åŒ–ä¸Šä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œå¯ä»¥åœ¨valueä¸­è®¾ç½®ä¸€ä¸ªtimeoutå€¼ï¼Œè¿™ä¸ªtimeoutçš„å€¼å°äºç¼“å­˜çš„è¿‡æœŸæ—¶é—´ï¼Œå½“å–åˆ°ç¼“å­˜æ—¶å¼‚æ­¥åˆ¤æ–­valueä¸­çš„timeoutæ˜¯å¦è¿‡æœŸäº†ï¼Œå¦‚è¿‡æœŸäº†é‡æ–°è·å–ä¸€æ¬¡æ–°å€¼ã€‚

**è§£å†³æ–¹æ¡ˆä¸‰ï¼š**
ä½¿ç”¨äº’æ–¥é”ï¼ˆmutex keyï¼‰ï¼šæ„å»ºç¼“å­˜æ—¶é€šè¿‡åˆ†å¸ƒå¼é”åªè®©ä¸€ä¸ªçº¿ç¨‹è¿›è¡ŒæŸ¥åº“ï¼Œå…¶ä½™çº¿ç¨‹é˜»å¡ç›´åˆ°æŸ¥åº“çš„çº¿ç¨‹è·å–åˆ°æ•°æ®åä»ç¼“å­˜ä¸­æ‹¿å–ã€‚



**å‚è€ƒ:**

> [ç¼“å­˜çƒ­ç‚¹keyé—®é¢˜(mutex key)](https://blog.csdn.net/babyff00/article/details/52658698)
> [å®ä¾‹è§£è¯»ä»€ä¹ˆæ˜¯Redisç¼“å­˜ç©¿é€ã€ç¼“å­˜é›ªå´©å’Œç¼“å­˜å‡»ç©¿](https://baijiahao.baidu.com/s?id=1619572269435584821&wfr=spider&for=pc)