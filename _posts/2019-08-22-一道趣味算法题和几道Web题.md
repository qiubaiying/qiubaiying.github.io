---
layout:     post
title:      MOCTFWé¢˜ç›®è®²è§£
subtitle:   ä¸€é“ç®—æ³•é¢˜å’Œå‡ é“Webé¢˜çš„è§£é¢˜æ–¹æ³•
date:       2019-08-22
author:     MHYCDH
header-img: img/19-08-22/title.png
catalog: true
tags:
    - CTF
    - ç®—æ³•(algorithm)
---

# å‰è¨€

~~æ¥è¿‘å¼€å­¦å­£äº†,è¯¥æ‹¿ç‚¹ä¸œè¥¿å‡ºæ‰‹äº†~~

åºŸè¯ä¸å¤šå†™,å’±ä»¬ç›´æ¥æ¥çœ‹çœ‹å†…å®¹;

è¿™é“æ˜¯æœ€è¿‘çš„ç®—æ³•é¢˜å½“ä¸­æ¯”è¾ƒæœ‰è¶£çš„ä¸€é“é¢˜,æ¥è‡ªLeetCode num.198å·çš„é¢˜ç›®

**é¢˜ç›®åå­—:æ‰“å®¶åŠ«èˆ**


#### é¢˜ç›®æè¿°

ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å°å·ï¼Œè®¡åˆ’å·çªƒæ²¿è¡—çš„æˆ¿å±‹ã€‚æ¯é—´æˆ¿å†…éƒ½è—æœ‰ä¸€å®šçš„ç°é‡‘ï¼Œå½±å“ä½ å·çªƒçš„å”¯ä¸€åˆ¶çº¦å› ç´ å°±æ˜¯ç›¸é‚»çš„æˆ¿å±‹è£…æœ‰ç›¸äº’è¿é€šçš„é˜²ç›—ç³»ç»Ÿ.**å¦‚æœä¸¤é—´ç›¸é‚»çš„æˆ¿å±‹åœ¨åŒä¸€æ™šä¸Šè¢«å°å·é—¯å…¥ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æŠ¥è­¦ã€‚**

ç»™å®šä¸€ä¸ªä»£è¡¨æ¯ä¸ªæˆ¿å±‹å­˜æ”¾é‡‘é¢çš„éè´Ÿæ•´æ•°æ•°ç»„ï¼Œè®¡ç®—ä½ åœ¨**ä¸è§¦åŠ¨è­¦æŠ¥è£…ç½®çš„æƒ…å†µä¸‹**ï¼Œèƒ½å¤Ÿå·çªƒåˆ°çš„æœ€é«˜é‡‘é¢ã€‚

ç¤ºä¾‹ 1:

```

è¾“å…¥: [1,2,3,1]
è¾“å‡º: 4
è§£é‡Š: å·çªƒ 1 å·æˆ¿å±‹ (é‡‘é¢ = 1) ï¼Œç„¶åå·çªƒ 3 å·æˆ¿å±‹ (é‡‘é¢ = 3)ã€‚
     å·çªƒåˆ°çš„æœ€é«˜é‡‘é¢ = 1 + 3 = 4 ã€‚
```
ç¤ºä¾‹ 2:

```

è¾“å…¥: [2,7,9,3,1]
è¾“å‡º: 12
è§£é‡Š: å·çªƒ 1 å·æˆ¿å±‹ (é‡‘é¢ = 2), å·çªƒ 3 å·æˆ¿å±‹ (é‡‘é¢ = 9)ï¼Œæ¥ç€å·çªƒ 5 å·æˆ¿å±‹ (é‡‘é¢ = 1)ã€‚
     å·çªƒåˆ°çš„æœ€é«˜é‡‘é¢ = 2 + 9 + 1 = 12 ã€‚
```

### è§£å†³æ–¹æ¡ˆ

æ ¹æ®è¿™é“é¢˜çš„æ¡ä»¶ç‰¹ç‚¹ï¼š
**å¦‚æœä¸¤é—´ç›¸é‚»çš„æˆ¿å±‹åœ¨åŒä¸€æ™šä¸Šè¢«å°å·é—¯å…¥ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æŠ¥è­¦**ï¼ˆå³ç›¸é‚»çš„æ•°å­—ä¸èƒ½åŒæ—¶ä½œä¸ºæœ€ç»ˆæ±‚å’Œçš„æœ‰æ•ˆæ•°å­—ï¼‰ã€‚

### åˆ†æ

è¿™ä¸ªæ¡ä»¶å¦‚æœç²¾ç®€æ‰å…¶ä»–å†…å®¹ï¼Œå¾ˆå®¹æ˜“è®©äººè”æƒ³åˆ°å¥‡å¶æ•°ã€‚è¿™ä¸ªè§£æ³•å°±æ˜¯ä»è¿™ç‚¹å‡ºå‘ã€‚

- è®¾ç½®ä¸¤ä¸ªå˜é‡ï¼Œ`sumOdd` å’Œ `sumEven` åˆ†åˆ«å¯¹æ•°ç»„çš„å¥‡æ•°å’Œå¶æ•°å…ƒç´ æ±‚å’Œã€‚
- æœ€åæ¯”è¾ƒè¿™ä¸¤ä¸ªå’Œè°æ›´å¤§ï¼Œè°å°±æ˜¯æœ€ä¼˜è§£ã€‚

å¯ä»¥çœ‹çœ‹è¿™ä¸ªæˆåŠŸçš„ä¾‹å­

![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/1.png?raw=true)

>æ¥ä¸‹æ¥è¦è§£å†³çš„å°±æ˜¯æœ€ä¼˜è§£ä¸æ˜¯çº¯å¥‡æ•°å’Œæˆ–è€…å¶æ•°å’Œçš„æƒ…å†µã€‚

>è¿™ç§æƒ…å†µä¸‹ï¼Œæœ€ä¼˜è§£å¯èƒ½å‰åŠæ®µå‡ºç°åœ¨è¿™è¾¹ï¼ŒååŠæ®µå‡ºç°åœ¨å¦ä¸€è¾¹ã€‚  
é‚£ä¹ˆåªè¦æ‰¾åˆ°ä¸€ä¸ªæ—¶æœºï¼Œå½“è¿™ä¸€æ®µçš„æœ€ä¼˜è§£æ²¡æœ‰å¦ä¸€è¾¹å¥½æ—¶ï¼Œå°±å¤åˆ¶å¯¹é¢çš„æœ€ä¼˜è§£è¿‡æ¥ã€‚

ä¾‹å¦‚:

![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/2.png?raw=true)

å½“å¶æ•°å’Œï¼ˆå¥‡å¶æŒ‡çš„æ•°ç»„ä¸‹æ ‡ï¼‰åŠ åˆ°ç¬¬äºŒä¸ª 1 ä¹‹åï¼Œå‘ç°è¿˜ä¸å¦‚å¥‡æ•°å’Œä¸€ä¸ª 3 å¤§ï¼Œå°±åº”è¯¥å°†å¯¹é¢çš„3å¤åˆ¶è¿‡æ¥æ›¿æ¢æ‰è‡ªå·±çš„ 2ã€‚

![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/3.png?raw=true)

ç»§ç»­è®¡ç®—åå¾—åˆ°æœ€ä¼˜è§£ã€‚

### ä»£ç æ€è·¯

1.è®¾ç½®ä¸¤ä¸ªå˜é‡ï¼Œ`sumOdd` å’Œ `sumEven` åˆ†åˆ«å¯¹æ•°ç»„çš„å¥‡æ•°å’Œå¶æ•°å…ƒç´ æ±‚å’Œã€‚

2.éå†æ•°ç»„ï¼Œç´¢å¼•ä¸ºå¥‡æ•°æ—¶ï¼Œå°†å…ƒç´ åŠ åˆ°å¥‡æ•°å’Œï¼Œå¹¶ä¸å¶æ•°å’Œæ¯”è¾ƒæ›´æ–°æˆmaxã€‚

3.å¶æ•°å’ŒåŒç†ã€‚

4.è¿”å›æ—¶è¿›è¡Œæœ€åä¸€æ¬¡æ›´æ–°maxã€‚

```c++
//ä»£ç æºè‡ªleetcodeç”¨æˆ·"lkaruga"

int rob(vector<int>& nums) 
{
  int sumOdd = 0;
  int sumEven = 0;

  for (int i = 0; i < nums.size(); i++)
  {
    if (i % 2 == 0)
    {
      sumEven += nums[i];
      sumEven = max(sumOdd, sumEven);
    }
    else
    {
      sumOdd += nums[i];
      sumOdd = max(sumOdd, sumEven);
    }
  }
  return max(sumOdd, sumEven);
}
```

å¥½äº†,æ¥ä¸‹æ¥å°±æ˜¯ä¸»è¦çš„éš¾é¢˜äº†,è™½ç„¶å’Œå‰é¢çš„é¢˜ç›®æ²¡ä»€ä¹ˆå…³ç³» ((ğŸ˜))

## MOCTFçš„Webé¢˜è§£é¢˜ç¯èŠ‚

MOCTFéƒ¨åˆ†Webé¢˜è§£ MOCTFçš„é¢˜ç›®è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œæ–‡ç« å¼•ç”¨é›¶é‡°å®éªŒå®¤æˆå‘˜"å—å®«åå…­"çš„è§£é¢˜æ–¹æ³•

è¿™é‡Œæ˜¯å®˜ç½‘ğŸ‘‰[MOCTFå®˜ç½‘](http://www.moctf.com)

>å‰é¢ä¸¤é¢˜ç®€ç›´é€åˆ†,ç›´æ¥è·³åˆ°ç¬¬ä¸‰é¢˜

#### web3:è®¿é—®é™åˆ¶

è®¿é—®æç¤º"åªå…è®¸ä½¿ç”¨NAIVEæµè§ˆå™¨è®¿é—®ï¼"ï¼Œé‚£å°±æŠŠUser-Agentæ”¹æˆNAIVEè¯•è¯• 

![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/4.png?raw=true)

åˆæç¤ºåªå…è®¸é¦™æ¸¯è®°è€…è®¿é—® 

![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/5.png?raw=true)

æ‰€ä»¥åˆæŠŠAccept-Languageæ”¹æˆäº†zh-HK 

![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/6.png?raw=true)

å‘åŒ…æ‹¿åˆ°flag 

![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/7.png?raw=true)

#### web4:æœºå™¨è›‡

ä½ ä»¥ä¸ºçœŸè®©ä½ ç©æ¸¸æˆä¹ˆï¼Ÿ

![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/8.png?raw=true)

å³é”®å®¡æ ¸å…ƒç´ ï¼Œæç¤ºrobots.txt 

![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/9.png?raw=true)

è®¿é—®çœ‹åˆ°ä¸€ä¸ªphpæ–‡ä»¶ 

![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/10.png?raw=true)

è®¿é—®è¯¥phpæ–‡ä»¶ï¼Œä¾æ—§æ˜¯ç©ºç™½ï¼Œç„¶åå³é”®æŸ¥çœ‹æºä»£ç å°±æ‹¿åˆ°flagå•¦ 

![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/11.png?raw=true)

#### web5:PHPé»‘é­”æ³•

é¢˜ç›®æç¤ºå¥½åƒæœ‰æºç ï¼Œä½†æ˜¯è®¿é—®å´çœ‹ä¸åˆ°ä»»ä½•ä¸œè¥¿ï¼Œæƒ³åˆ°å¯èƒ½æ˜¯phpæºä»£ç æ³„éœ² å‡ ç§å¸¸è§çš„æ ¼å¼ï¼š`index.php.bak;` `index.php.swp;` `index.php~` è®¿é—®`index.php~`æ‹¿åˆ°æºä»£ç  

![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/12.png?raw=true)

ä»£ç å¤§æ¦‚çš„æ„æ€æ˜¯ï¼šä¼ å…¥å‚æ•°aå’Œbï¼Œä¸èƒ½ä¸ºç©ºï¼Œaå’Œbä¸èƒ½ç›¸ç­‰ã€‚è¿™ä¸¤ä¸ªå‚æ•°å¦‚æœç»è¿‡md5åŠ å¯†åç›¸ç­‰ï¼Œè¾“å‡ºflagã€‚21è¡Œé‚£é‡Œå¯è¿›è¡Œmd5ç»•è¿‡ï¼Œphpå¼±ç±»å‹ã€‚æˆ‘ä»¬åªéœ€æ„é€ `index.php?a=QNKCDZO&b=240610708`å³å¯æ‹¿åˆ°flagï¼Œä¹Ÿå¯ä»¥æ•°ç»„ç»•è¿‡ï¼Œæ„é€ `index.php?a[]=1&b[]=2`å³å¯ 

![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/13.png?raw=true)

#### web6:æˆ‘æƒ³è¦é’±

é¢˜ç›®ç›´æ¥è´´å‡ºäº†æºç  

![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/14.png?raw=true)

è®©ä¼ å…¥ä¸€ä¸ªmoneyå‚æ•°ï¼Œç„¶åå®ƒçš„å€¼å¿…é¡»æ»¡è¶³å°äºç­‰äº4ä½ï¼Œå¹¶ä¸”è¿™ä¸ªå€¼è¦å¤§äºå½“å‰æ—¶é—´æˆ³ï¼Œä¸”ä¸èƒ½ä¸ºæ•°ç»„ã€‚æƒ³åˆ°ç”¨ç§‘å­¦è®¡æ•°æ³•è®©ä»–å¤§äºæ—¶é—´æˆ³ï¼Œè¿™é‡Œå¯ä»¥ç”¨ç§‘å­¦è®¡æ•°æ³•æ ¼å¼è¾“å‡ºä¸€ä¸‹å½“å‰çš„æ—¶é—´æˆ³

![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/15.png?raw=true)

æ„é€ url:`index.php?money=2e09` 

![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/16.png?raw=true)

#### web7:ç™»å½•å°±å¯¹äº†

æç¤ºéœ€è¦ç™»å½•ï¼Œç„¶åé¡µé¢æ ‡é¢˜æ˜¯SQLi LOGINï¼Œä¸ç”¨æƒ³äº†è‚¯å®šæ˜¯ä¸‡èƒ½å¯†ç  æ„é€ ç”¨æˆ·å:`' or '1'='1'##`ï¼Œå¯†ç éšæ„ï¼ŒæˆåŠŸç™»å½• 

![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/17.png?raw=true)


#### web8:æ–‡ä»¶åŒ…å«

éƒ½è¿™ä¹ˆæ˜æ˜¾äº†ï¼Œå°±æ˜¯æ–‡ä»¶åŒ…å«ï¼Œè¯•äº†å‡ ç§æ–¹æ³•ï¼Œå‘ç°`php://filter/read=convert.base64-encode/resource=xxx`è¿™ç§æ–¹æ³•å¯è¡Œï¼Œå°è¯•åŒ…å«æœåŠ¡å™¨çš„`flag.php`æ–‡ä»¶ 

![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/18.png?raw=true)

base64è§£ç ä¸€ä¸‹å¾—åˆ°flag

#### web9:æš´è·³è€æ¿

å‘é‚®ä»¶çš„æ—¶å€™æŠ“ä¸ªåŒ…ï¼Œç„¶åå‘é€å‡ºå»çœ‹çœ‹è¿”å›äº†ä»€ä¹ˆ 

![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/19.png?raw=true)

å‘ç°è¿”å›åŒ…ä¸­æœ‰ä¸€æ¡Dear: MyBoss æ„é€ url:`postText=1&Dear=MyBoss` 

![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/20.png?raw=true)

#### web10:Flagåœ¨å“ªï¼Ÿ

æ‰“å¼€ä»¥åè·³è½¬åˆ°äº†`no_flag.php`ï¼Œç„¶åè®¿é—®`flag.php`æœ€ç»ˆä¹Ÿæ˜¯è·³è½¬åˆ°`no_flag.php`ï¼ŒæŠ“åŒ…è¯•è¯• é‡å®šå‘äº†å¥½å¤šæ¬¡ï¼Œæœ€ç»ˆå¾—åˆ°å¦‚ä¸‹å‡ ä¸ªæ–‡ä»¶ï¼š

```
flag.php
where_is_flag.php
I_have_a_flag.php
I_have_a_frog.php
no_flag.php
```

ä»”ç»†ç§ç§ï¼Œè¿™ä¸æ˜¯PPAPçš„æ­Œè¯å—ï¼Ÿï¼Ÿï¼Ÿ I have a pen,I have an apple. (Uhh~)Apple-pen! è¯•è¯•è®¿é—®flag-frog.phpï¼Œå‘ç°ä¸è¡Œï¼Œè€Œæ”¹æˆflagfrog.phpå°±è¡Œäº†ï¼ 

![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/21.png?raw=true)

#### web11:ç¾å‘³çš„é¥¼å¹²

ç¾å‘³çš„é¥¼å¹²ï¼Œæ ¹æ®æ ‡é¢˜æ„Ÿè§‰å’Œcookieæœ‰å…³ å…ˆéšä¾¿è¾“å…¥è´¦æˆ·å¯†ç ï¼Œå‘ç°å¯ä»¥ç™»å½• 

![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/22.png?raw=true)

ç„¶åæ¥ç€çœ‹çœ‹cookieï¼Œå‘ç°æ˜¯base64ç¼–ç ï¼Œè§£å¯†ä¹‹åæ˜¯md5ï¼Œç„¶ååœ¨å¯¹md5è¿›è¡Œè§£å¯†ï¼Œå‘ç°æ˜¯user 

![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/23.png?raw=true)


![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/24.png?raw=true)

æˆ‘æ„Ÿè§‰æŠŠä»–å˜æˆadminå¯èƒ½å¯è¡Œï¼Œæ‰€ä»¥è¯•äº†è¯• 

![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/25.png?raw=true)

æŠŠadminç»è¿‡md5åŠ å¯†ï¼Œç„¶ååœ¨ç»è¿‡base64ç¼–ç ï¼Œæœ€åæŠŠè¿™ä¸ªå€¼æ›¿æ¢cookieï¼Œé‡æ–°è®¿é—®é¡µé¢æ‹¿åˆ°flag

#### web12:æ²¡æ—¶é—´è§£é‡Šäº†

è¿™é“é¢˜ä¸Šæ¥å°±æ˜¯è®©ä½ è®¿é—®index2.phpï¼Œç„¶åå¾—ä¸åˆ°ä»»ä½•æœ‰ç”¨çš„ä¿¡æ¯ï¼Œæ‰€ä»¥æŠŠå®ƒæ”¹æˆindex.phpè¯•è¯• 

![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/26.png?raw=true)

æˆ‘ä»¬è®¿é—®å¾—åˆ°çš„è¿™ä¸ªé¡µé¢ï¼Œå‘ç°è®©ä½ æäº¤Filenameå’ŒContentï¼Œéšä¾¿å†…å®¹å³å¯ï¼Œç„¶åä¼šå¾—åˆ°ä¸€ä¸ªURLï¼Œä½†æ˜¯è®¿é—®å´æ˜¾ç¤ºToo slow! 

![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/28.png?raw=true)

é€šè¿‡burpæäº¤ï¼Œå‘ç°å¤šæ¬¡æäº¤ä¸€æ ·çš„å†…å®¹è¿”å›çš„urlæ˜¯ä¸€æ ·çš„ 

![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/29.png?raw=true)

æ‰€ä»¥è¯´å¯èƒ½æ˜¯æœåŠ¡å™¨æœ‰ä¸ªè‡ªåŠ¨åˆ æ–‡ä»¶çš„è„šæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥è®©burpä¸€ç›´æäº¤ä¸€ç›´æäº¤ï¼Œç„¶ååœ¨è®¿é—®è¯•è¯•(å½“ç„¶pythonä¹Ÿå¯ä»¥ï¼Œæˆ‘å°±ä¸é€ è½®å­äº†) è®¾ç½®ä¸€ä¸ªæ— payloadçš„æ¨¡å¼ï¼Œç„¶åè®©ä»–ä¸€ç›´å‘åŒ…å°±å¯ä»¥äº† 

å†æ¬¡è®¿é—®urlå¾—åˆ°flag 

![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/30.png?raw=true)

## ç»“è¯­

å•Šå•Š! ç°åœ¨æ‰æƒ³èµ·æ¥,ä¸Šä¸€å¹´çš„å¤§ä¸€çš„æ€»ç»“è¿˜æ²¡æœ‰å†™å‘¢(~~æ‰€ä»¥è¿™ç¯‡å°±æ°´å®Œäº†?~~).å¥½å§,è¯·æœŸå¾…æˆ‘å†™çš„ä¸‹ä¸€ç¯‡<<~~ä»€ä¹ˆæ˜¯å›½é™…å·¨æ˜Ÿ~~>>

æ‰“é”™äº†,åº”è¯¥æ˜¯<<è¯·æ›¿æˆ‘æ„Ÿè°¢æ‰€æœ‰æˆ‘é‡åˆ°çš„äºº>>

![](https://github.com/MHYCDH/MHYCDH.github.io/blob/master/img/19-08-22/31.gif?raw=true)
>çœ‹é—¨ç‹—ç¥ä½ ä¸Šç½‘å®‰å…¨æ„‰å¿«
