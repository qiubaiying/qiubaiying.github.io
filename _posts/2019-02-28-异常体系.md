---
layout: post
title: Javaä¸­çš„å¼‚å¸¸ä½“ç³»
subtitle: åŸºç¡€é¸­ðŸ˜ðŸ˜ðŸ˜
date: 2019-02-28
author: åŽä»”
header-img: img/post-bg-debug.png
catalog: true
tags:
    - Java
    - åŸºç¡€çŸ¥è¯†
---

![Javaä¸­çš„å¼‚å¸¸åˆ†ç±»ç»§æ‰¿å…³ç³»](http://blog-ipic.yananhuazai.cn/FugNDyJLNH-k0azNsv7H_cOtfcWn "Javaä¸­çš„å¼‚å¸¸åˆ†ç±»ç»§æ‰¿å…³ç³»")

> ![](http://blog-ipic.yananhuazai.cn/FrbaC4BXRigkMeIRk7UAyFqodFNH)



# javaå¼‚å¸¸ä½“ç³»ç»“æž„

### Errorå’ŒException

Erroræ˜¯ç¨‹åºæ— æ³•å¤„ç†çš„é”™è¯¯ï¼Œæ¯”å¦‚OutOfMemoryErrorã€ThreadDeathç­‰ã€‚è¿™äº›å¼‚å¸¸å‘ç”Ÿæ—¶ï¼ŒJavaè™šæ‹Ÿæœºï¼ˆJVMï¼‰ä¸€èˆ¬ä¼šé€‰æ‹©çº¿ç¨‹ç»ˆæ­¢ã€‚



### è¿è¡Œæ—¶å¼‚å¸¸å’Œéžè¿è¡Œæ—¶å¼‚å¸¸

â€‹	è¿è¡Œæ—¶å¼‚å¸¸éƒ½æ˜¯RuntimeExceptionç±»åŠå…¶å­ç±»å¼‚å¸¸ï¼Œå¦‚NullPointerExceptionã€IndexOutOfBoundsExceptionç­‰ï¼Œè¿™äº›å¼‚å¸¸æ˜¯ä¸æ£€æŸ¥å¼‚å¸¸ï¼Œç¨‹åºä¸­å¯ä»¥é€‰æ‹©æ•èŽ·å¤„ç†ï¼Œä¹Ÿå¯ä»¥ä¸å¤„ç†ã€‚è¿™äº›å¼‚å¸¸ä¸€èˆ¬æ˜¯ç”±ç¨‹åºé€»è¾‘é”™è¯¯å¼•èµ·çš„ï¼Œç¨‹åºåº”è¯¥ä»Žé€»è¾‘è§’åº¦å°½å¯èƒ½é¿å…è¿™ç±»å¼‚å¸¸çš„å‘ç”Ÿã€‚
â€‹	éžè¿è¡Œæ—¶å¼‚å¸¸æ˜¯RuntimeExceptionä»¥å¤–çš„å¼‚å¸¸ï¼Œç±»åž‹ä¸Šéƒ½å±žäºŽExceptionç±»åŠå…¶å­ç±»ã€‚ä»Žç¨‹åºè¯­æ³•è§’åº¦è®²æ˜¯å¿…é¡»è¿›è¡Œå¤„ç†çš„å¼‚å¸¸ï¼Œå¦‚æžœä¸å¤„ç†ï¼Œç¨‹åºå°±ä¸èƒ½ç¼–è¯‘é€šè¿‡ã€‚å¦‚IOExceptionã€SQLExceptionç­‰ä»¥åŠç”¨æˆ·è‡ªå®šä¹‰çš„Exceptionå¼‚å¸¸ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸è‡ªå®šä¹‰æ£€æŸ¥å¼‚å¸¸ã€‚





# å¼‚å¸¸çš„æ•èŽ·å’Œå¤„ç†

```java
try{
    //å¯èƒ½å‡ºçŽ°å¼‚å¸¸
}catch(Throwable1 t1) {
    //å¤„ç†å¼‚å¸¸
}catch(Throwable2 t2) {
    //å¤„ç†å¼‚å¸¸
}finally{
    //å§‹ç»ˆæ‰§è¡Œçš„ä»£ç å—
}
```

å¼‚å¸¸æ•èŽ·æ—¶å€™ä»…ä»…tryä»£ç å—ä¸ºå¿…é¡»çš„ï¼Œå…¶ä½™çš„å¯ä»¥é€‰ç”¨ï¼Œä¾‹å¦‚å¯ä»¥ï¼štry catchæˆ–try finallyæˆ–try catch finallyã€‚å¹¶ä¸”catchä»£ç å—å¯ä»¥æœ‰å¤šä¸ªï¼Œä½†æ˜¯å¿…é¡»å¤§èŒƒå›´catchåœ¨ä¸‹ï¼Œä¾‹å¦‚try catch(NullPointerException e) catch(Exception e)...ä»¥æ­¤ç±»æŽ¨ã€‚



# try-with-resources

åœ¨JDK1.7æ—¶ï¼Œæä¾›äº†try-with-resourcesï¼Œç”¨äºŽæ–¹ä¾¿é‡Šæ”¾ioèµ„æºæˆ–å…¶ä»–ã€‚


```java
public class Demo {
    public static void main(String[] args) {
        BufferedInputStream bin = null;
        BufferedOutputStream bout = null;
        try {
            bin = new BufferedInputStream(new FileInputStream(new File("test.txt")));
            bout = new BufferedOutputStream(new FileOutputStream(new File("out.txt")));
            int b;
            while ((b = bin.read()) != -1) {
                bout.write(b);
            }
        }
        catch (IOException e) {
            e.printStackTrace();
        }
        finally {
            if (bin != null) {
                try {
                    bin.close();
                }
                catch (IOException e) {
                    e.printStackTrace();
                }
                finally {
                    if (bout != null) {
                        try {
                            bout.close();
                        }
                        catch (IOException e) {
                            e.printStackTrace();
                        }
                    }
                }
            }
        }
    }
}
```

ä¸Šè¿°ä»£ç ä½¿ç”¨ä¸€ä¸ªè¾“å‡ºæµbinå’Œä¸€ä¸ªè¾“å…¥å…­boutï¼Œå°†ä¸€ä¸ªæ–‡ä»¶ä¸­çš„æ•°æ®å†™å…¥å¦ä¸€ä¸ªæ–‡ä»¶ã€‚ç”±äºŽIOèµ„æºéžå¸¸å®è´µï¼Œå› æ­¤åœ¨å®Œæˆæ“ä½œåŽï¼Œå¿…é¡»åœ¨finallyä¸­åˆ†åˆ«é‡Šæ”¾è¿™ä¸¤ä¸ªèµ„æºã€‚å¹¶ä¸”ä¸ºäº†èƒ½å¤Ÿæ­£ç¡®é‡Šæ”¾è¿™ä¸¤ä¸ªIOèµ„æºï¼Œéœ€è¦ç”¨ä¸¤ä¸ªfinallyä»£ç å—åµŒå¥—çš„æ–¹å¼å®Œæˆèµ„æºçš„é‡Šæ”¾ã€‚

åœ¨ä¸Šè¿°40è¡Œä»£ç ä¸­ï¼ŒçœŸæ­£å¤„ç†IOæ“ä½œçš„ä»£ç ä¸åˆ°10è¡Œï¼Œè€Œå…¶ä½™30è¡Œä»£ç éƒ½æ˜¯ç”¨äºŽä¿è¯èµ„æºåˆç†é‡Šæ”¾çš„ã€‚è¿™æ˜¾ç„¶å¯¼è‡´ä»£ç å¯è¯»æ€§è¾ƒå·®ã€‚ä¸è¿‡å¥½åœ¨JDK 1.7æä¾›äº†try-with-resourcesè§£å†³è¿™ä¸€é—®é¢˜ã€‚ä¿®æ”¹åŽçš„ä»£ç å¦‚ä¸‹ï¼š

```java
public class TryWithResource {
    public static void main(String[] args) {
        try (BufferedInputStream bin = new BufferedInputStream(new FileInputStream(new File("test.txt")));
             BufferedOutputStream bout = new BufferedOutputStream(new FileOutputStream(new File("out.txt")))) {
            int b;
            while ((b = bin.read()) != -1) {
                bout.write(b);
            }
        }
        catch (IOException e) {
            e.printStackTrace();
        }
    }
}
```

æˆ‘ä»¬éœ€è¦å°†èµ„æºå£°æ˜Žä»£ç æ”¾å…¥tryåŽçš„æ‹¬å·ä¸­ï¼Œç„¶åŽå°†èµ„æºå¤„ç†ä»£ç æ”¾å…¥tryåŽçš„{}ä¸­ï¼Œcatchä»£ç å—ä¸­ä»ç„¶è¿›è¡Œå¼‚å¸¸å¤„ç†ï¼Œå¹¶ä¸”æ— éœ€å†™finallyä»£ç å—ã€‚

é‚£ä¹ˆï¼Œtry-with-resourcesä¸ºä»€ä¹ˆèƒ½å¤Ÿé¿å…å¤§é‡èµ„æºé‡Šæ”¾ä»£ç å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ï¼Œç”±Javaç¼–è¯‘å™¨æ¥å¸®æˆ‘ä»¬æ·»åŠ finallyä»£ç å—ã€‚æ³¨æ„ï¼Œç¼–è¯‘å™¨åªä¼šæ·»åŠ finallyä»£ç å—ï¼Œè€Œèµ„æºé‡Šæ”¾çš„è¿‡ç¨‹éœ€è¦èµ„æºæä¾›è€…æä¾›ã€‚

åœ¨JDK 1.7ä¸­ï¼Œæ‰€æœ‰çš„IOç±»éƒ½å®žçŽ°äº†AutoCloseableæŽ¥å£ï¼Œå¹¶ä¸”éœ€è¦å®žçŽ°å…¶ä¸­çš„close()å‡½æ•°ï¼Œèµ„æºé‡Šæ”¾è¿‡ç¨‹éœ€è¦åœ¨è¯¥å‡½æ•°ä¸­å®Œæˆã€‚

é‚£ä¹ˆï¼Œç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶ï¼Œä¼šè‡ªåŠ¨æ·»åŠ finallyä»£ç å—ï¼Œå¹¶å°†close()å‡½æ•°ä¸­çš„èµ„æºé‡Šæ”¾ä»£ç åŠ å…¥finallyä»£ç å—ä¸­ã€‚ä»Žè€Œæé«˜ä»£ç å¯è¯»æ€§ã€‚





# å¼‚å¸¸å±è”½

**å¦‚æžœåœ¨try catch finallyä¸­å‡æœ‰å¼‚å¸¸æŠ›å‡ºï¼Œé‚£ä¹ˆæœ€ç»ˆåªä¼šæŠ›å‡ºfinallyä¸­çš„å¼‚å¸¸**

```java
public class TestThrowable {
    public static void main(String[] args) {
        try {
            throw new RuntimeException("finallyä¸­æŠ›å‡ºå¼‚å¸¸");
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("catchä¸­æŠ›å‡ºå¼‚å¸¸");
        } finally {
            throw new RuntimeException("finallyä¸­æŠ›å‡ºå¼‚å¸¸");
        }
    }
}
```

æ‰§è¡Œç»“æžœï¼š

```java
java.lang.RuntimeException: finallyä¸­æŠ›å‡ºå¼‚å¸¸
	at cn.huazai.main.throwable_example.TestThrowable.main(TestThrowable.java:12)
Exception in thread "main" java.lang.RuntimeException: finallyä¸­æŠ›å‡ºå¼‚å¸¸
	at cn.huazai.main.throwable_example.TestThrowable.main(TestThrowable.java:17)
```

**æˆ–è€…å¦‚æžœtry catch finallyä¸­å‡æœ‰returnï¼Œé‚£ä¹ˆæœ€ç»ˆä¹Ÿåªä¼šè¿”å›žfinallyä¸­çš„å†…å®¹**

```java
public class TestThrowable {
    public static void main(String[] args) {
        System.out.println(test1()); //2
        System.out.println(test2()); //2
        System.out.println(test3()); //2
    }

    static int test1() {
        try {
            return 1;
        }finally {
            return 2;
        }
    }
    static int test2() {
        try {
            throw new Exception();
        }finally {
            return 2;
        }
    }
    static int test3() {
        try {
            throw new Exception();
        }catch (Exception e) {
            return 1;
        }finally {
            return 2;
        }
    }
}
```





# å¼‚å¸¸çš„è½¬è¯‘å’Œå¼‚å¸¸é“¾

### å¼‚å¸¸è½¬è¯‘

> **æ›´é«˜å±‚çš„å®žçŽ°åº”è¯¥æ•èŽ·åº•å±‚çš„å¼‚å¸¸ï¼ŒåŒæ—¶æŠ›å‡ºå¯ä»¥æŒ‰ç…§é«˜å±‚æŠ½è±¡è¿›è¡Œè§£é‡Šçš„å¼‚å¸¸**ã€‚è¿™ç§åšæ³•æˆä¸º**å¼‚å¸¸è½¬è¯‘**exception translationã€‚

```java
public class ThrowableTest02 {
    public static void main(String[] args) {
        try {
            Object obj = null;
            obj.toString();
        } catch (NullPointerException npe) { //åº•å±‚çš„å¼‚å¸¸
            throw new RuntimeException("è§£é‡Šå¼‚å¸¸", npe); //è½¬è¯‘æˆæ›´é«˜å±‚çš„å¼‚å¸¸
        }
    }
}
```

è¿è¡Œç»“æžœï¼š

```java
Exception in thread "main" java.lang.RuntimeException: è§£é‡Šå¼‚å¸¸
	at cn.huazai.main.throwable_example.ThrowableTest02.main(ThrowableTest02.java:15)
Caused by: java.lang.NullPointerException
	at cn.huazai.main.throwable_example.ThrowableTest02.main(ThrowableTest02.java:13)
```

å¼‚å¸¸è½¬è¯‘ä¸èƒ½æ»¥ç”¨ï¼Œå¦‚æœ‰å¯èƒ½ï¼Œå¤„ç†æ¥è‡ªä½Žå±‚å¼‚å¸¸çš„æœ€å¥½åšæ³•æ˜¯ï¼Œåœ¨è°ƒç”¨ä½Žå±‚æ–¹æ³•ä¹‹å‰ç¡®ä¿å®ƒä»¬ä¼šæˆåŠŸæ‰§è¡Œï¼Œä»Žè€Œé¿å…å®ƒä»¬æŠ›å‡ºå¼‚å¸¸ã€‚å¦‚æžœæ— æ³•é¿å…ä½Žå±‚å¼‚å¸¸ï¼Œæ¬¡é€‰æ–¹æ¡ˆæ˜¯è®©é«˜å±‚æ‚„æ‚„ç»•è¿‡è¿™äº›å¼‚å¸¸ï¼Œä»Žè€Œå°†é«˜å±‚æ–¹æ³•çš„è°ƒç”¨è€…ä¸Žä½Žå±‚çš„é—®é¢˜éš”ç¦»å¼€ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥ç”¨é€‚å½“çš„è®°å½•æœºåˆ¶ï¼ˆå¦‚:java.util.loggingï¼‰å°†å¼‚å¸¸è®°å½•ä¸‹æ¥ã€‚



### å¼‚å¸¸é“¾

ä¸€ç§ç‰¹æ®Šçš„å¼‚å¸¸è½¬è¯‘çš„å½¢å¼ç§°ä¸ºå¼‚å¸¸é“¾ï¼Œ**ä½Žå±‚çš„å¼‚å¸¸åŽŸå› è¢«ä¼ åˆ°é«˜å±‚çš„å¼‚å¸¸ï¼Œé«˜å±‚çš„å¼‚å¸¸æä¾›è®¿é—®æ–¹æ³•æ¥èŽ·å¾—ä½Žå±‚çš„å¼‚å¸¸ã€‚**å¤§å¤šæ•°æ ‡å‡†çš„å¼‚å¸¸éƒ½æœ‰æ”¯æŒé“¾çš„æž„é€ å™¨ï¼Œå¯¹äºŽæ²¡æœ‰æ”¯æŒå¼‚å¸¸é“¾çš„å¼‚å¸¸ï¼Œå¯ä»¥åˆ©ç”¨Throwableçš„initCauseæ–¹æ³•è®¾ç½®åŽŸå› ã€‚å¼‚å¸¸é“¾ä¸ä»…è®©ä½ å¯ä»¥é€šè¿‡ç¨‹åºè®¿é—®åŽŸå› ï¼Œå®ƒè¿˜å¯ä»¥å°†åŽŸå› çš„å †æ ˆè½¨è¿¹é›†æˆåˆ°æ›´é«˜å±‚çš„å¼‚å¸¸ä¸­ã€‚

```java
public class MyExceptionTest {
    public static void main(String[] args) {
        try {
            new TestMain().a();
        } catch (MyException2 e) {
            e.printStackTrace();
        }
    }
}
class MyException1 extends Exception {
}
class MyException2 extends Exception {
    public MyException2() {
        super();
    }
    public MyException2(Throwable cause) {
        super(cause);
    }
}
class TestMain {
    public void a() throws MyException2 {
        try {
            b();
        } catch (MyException1 e) {
            e.printStackTrace();
            throw new MyException2();
        }
    }

    public void b() throws MyException1 {
        throw new MyException1();
    }
}
```

è¿è¡Œç»“æžœï¼š

```java
cn.huazai.main.throwable_example.MyException1
	at cn.huazai.main.throwable_example.TestMain.b(MyExceptionTest.java:39)
	at cn.huazai.main.throwable_example.TestMain.a(MyExceptionTest.java:31)
	at cn.huazai.main.throwable_example.MyExceptionTest.main(MyExceptionTest.java:12)
cn.huazai.main.throwable_example.MyException2
	at cn.huazai.main.throwable_example.TestMain.a(MyExceptionTest.java:34)
	at cn.huazai.main.throwable_example.MyExceptionTest.main(MyExceptionTest.java:12)
```

![](http://blog-ipic.yananhuazai.cn/Flehu-4R3vtTjJ3noonyhHVsPRpB)

![](http://blog-ipic.yananhuazai.cn/FjOgNAE6Y1wi_GBALrc42sdKRg0I)



æ€»ç»“ï¼š**å¦‚æžœä¸èƒ½é˜»æ­¢æˆ–è€…å¤„ç†æ¥è‡ªæ›´ä½Žå±‚çš„å¼‚å¸¸ï¼Œä¸€èˆ¬çš„åšæ³•æ˜¯å¼‚å¸¸è½¬è¯‘ï¼Œé™¤éžä½Žå±‚æ–¹æ³•ç¢°å·§å¯ä»¥ä¿è¯å®ƒæŠ›å‡ºçš„æ‰€æœ‰å¼‚å¸¸å¯¹é«˜å±‚ä¹Ÿåˆé€‚æ‰å¯ä»¥å°†å¼‚å¸¸ä»Žåº•å±‚ä¼ æ’­åˆ°é«˜å±‚ã€‚å¼‚å¸¸é“¾å¯¹é«˜å±‚å’Œä½Žå±‚å¼‚å¸¸éƒ½æä¾›äº†æœ€ä½³çš„åŠŸèƒ½ï¼šå®ƒå…è®¸æŠ›å‡ºé€‚å½“çš„é«˜å±‚å¼‚å¸¸ï¼ŒåŒæ—¶åˆèƒ½æ•èŽ·åº•å±‚çš„åŽŸå› è¿›è¡Œå¤±è´¥åˆ†æž**ã€‚



> å‚è€ƒèµ„æ–™ï¼š
>
> [Javaå¼‚å¸¸ä½“ç³»ç»“æž„](https://blog.csdn.net/Junlixxu/article/details/6096266)
>
> [Javaå¼‚å¸¸ä½“ç³»ç»“æž„è¯¦è§£](https://www.cnblogs.com/hainange/p/6334042.html)
>
> [Javaå¼‚å¸¸ä½“ç³»ä¸­çš„ç§˜å¯†](https://blog.csdn.net/u010425776/article/details/79529568)
>
> [å¼‚å¸¸Exception](https://www.jianshu.com/p/4ca2372ad911)