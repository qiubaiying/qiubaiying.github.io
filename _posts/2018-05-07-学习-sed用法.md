---
layout:     post
title:      Linuxä¸­sedç”¨æ³•
subtitle:   è®©æˆ‘ä»¬é€šè¿‡ä¸€äº›æ —å­ğŸŒ°æ¥å­¦ä¹ sed~
date:       2018-05-07
author:     Rebecca.Wu
header-img: img/2899.jpg
catalog: true
tags:
    - å§¿åŠ¿
---

    <ä¸¾ä¾‹æ³•>ä»é›¶å¼€å§‹å­¦ä¹ sed

###sedç®€ä»‹

####sedå®šä¹‰
è®©æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹sedçš„å®šä¹‰
åœ¨ç»´åŸºç™¾ç§‘ä¸Šæ˜¯è¿™ä¹ˆå†™åˆ°ï¼š

<blockquote><p>sed (Stream EDitor) is a Unix utility that parses and transforms text, using a simple, compact programming language.</p></blockquote>

s-edä¹Ÿå«â€œæµç¼–è¾‘å™¨â€ï¼Œæ˜¯ä¸€ä¸ªUnixåº”ç”¨ç¨‹åºï¼Œä½¿ç”¨ç®€å•ã€ç´§å‡‘çš„ç¼–ç¨‹è¯­è¨€æ¥åˆ†æå’Œè½¬æ¢æ–‡æœ¬ã€‚<br/>

ä¹Ÿå°±æ˜¯è¯´sedæ˜¯ä¸€ä¸ª**ç¼–è¾‘å™¨**ï¼Œæ˜¯ç”¨æ¥å¤„ç†æ–‡æœ¬ç±»çš„å·¥å…·ã€‚<br/>

æ€»çš„æ¥è¯´ï¼Œsedæ˜¯é¢å‘è¡Œï¼ˆline-orientredï¼‰çš„æ–‡æœ¬å¤„ç†å™¨ï¼Œå®ƒå°†ä»ä¸€ä¸ªè¾“å…¥æµæˆ–è€…ä¸€ä¸ªæ–‡ä»¶é€šè¿‡line by lineçš„æ–¹å¼è¯»å–æ–‡æœ¬å†…å®¹åˆ°ä¸€ä¸ªæ¨¡å¼ç©ºé—´ï¼ˆpattern space ä¸€ä¸ªå†…éƒ¨ç¼“å­˜ï¼‰<br/>
sedå¯åˆ é™¤(delete)ã€æ”¹å˜(change)ã€æ·»åŠ (append)ã€æ’å…¥(insert)ã€åˆå¹¶ã€äº¤æ¢æ–‡ä»¶ä¸­çš„èµ„æ–™è¡Œï¼Œæˆ–è¯»å…¥å…¶å®ƒæ¡£çš„èµ„æ–™åˆ°æ–‡ä»¶ä¸­ï¼Œä¹Ÿå¯æ›¿æ¢(substuite)å®ƒä»¬å…¶ä¸­çš„å­—ä¸²ã€æˆ–è½¬æ¢(tranfer)å…¶ä¸­çš„å­—æ¯ç­‰ç­‰ã€‚<br/>

ä¾‹å¦‚ï¼šå°†æ–‡ä»¶ä¸­çš„è¿ç»­ç©ºç™½è¡Œåˆ æˆä¸€è¡Œã€"local"å­—ä¸²æ›¿æ¢æˆ"remote"
    "t"å­—æ¯è½¬æ¢æˆ"T"ã€å°†ç¬¬10è¡Œèµ„æ–™ä¸ç¬¬11èµ„æ–™åˆç­‰.
<br/>
æ€»åˆä¸Šè¿°æ‰€è¨€,å½“sedç”±æ ‡å‡†è¾“å…¥è¯»å…¥ä¸€è¡Œèµ„æ–™å¹¶æ”¾å…¥pattern spaceæ—¶,sedä¾ç…§sed script çš„ç¼–è¾‘æŒ‡ä»¤é€ä¸€å¯¹pattern spaceå†…çš„èµ„æ–™æ‰§è¡Œç¼–è¾‘,ä¹‹å¾Œ,å†ç”±pattern spaceå†…çš„ç»“æœé€åˆ°æ ‡å‡†è¾“å‡º,æ¥ç€å†å°†ä¸‹ä¸€è¡Œèµ„æ–™è¯»å…¥ã€‚å¦‚æ­¤é‡æ‰§è¡Œä¸Šè¿°åŠ¨ä½œ,ç›´è‡³è¯»>å®Œæ‰€æœ‰èµ„æ–™è¡Œä¸ºæ­¢ã€‚
<br/>
è®°ä½ï¼š
            (1)sedæ€»æ˜¯ä»¥è¡Œå¯¹è¾“å…¥è¿›è¡Œå¤„ç†
            (2)sedå¤„ç†çš„ä¸æ˜¯åŸæ–‡ä»¶è€Œæ˜¯åŸæ–‡ä»¶çš„æ‹·è´
<br/>
####sedç¼–è¾‘æŒ‡ä»¤æ ¼å¼
å‘½ä»¤è¡Œæ¦‚è¿°:
    sed ç¼–è¾‘æŒ‡ä»¤çš„æ ¼å¼å¦‚ä¸‹ :
              [address1[,address2]]function[argument]
å…¶ä¸­,ä½å€å‚æ•°address1 ã€address2 ä¸ºè¡Œæ•°æˆ–regular expressionå­—ä¸²,è¡¨ç¤ºæ‰€æ‰§è¡Œç¼–è¾‘çš„èµ„æ–™è¡Œ; å‡½æ•°å‚æ•° function[argument] ä¸º sed çš„å†…å®šå‡½æ•° , è¡¨ç¤ºæ‰§è¡Œçš„ç¼–è¾‘åŠ¨ä½œã€‚
<br/>
####sedçš„25ä¸ªåŸºæœ¬å‡½æ•°å‚æ•°(function argument)

    å‡½æ•°å‚æ•° åŠŸèƒ½
    : label  å»ºç«‹ script file å†…æŒ‡ä»¤äº’ç›¸å‚è€ƒçš„ä½ç½®ã€‚
    #  å»ºç«‹è§£
    { }  é›†åˆæœ‰ç›¸åŒä½å€å‚æ•°çš„æŒ‡ä»¤ã€‚
    !  ä¸æ‰§è¡Œå‡½æ•°å‚æ•°ã€‚
    =  å°å‡ºèµ„æ–™è¡Œæ•°( line number )ã€‚
    a/  æ·»åŠ ä½¿ç”¨è€…è¾“å…¥çš„èµ„æ–™ã€‚
    b label  å°†æ‰§è¡Œçš„æŒ‡ä»¤è·³è‡³ç”± : å»ºç«‹çš„å‚è€ƒä½ç½®ã€‚
    c/  ä»¥ä½¿ç”¨è€…è¾“å…¥çš„èµ„æ–™å–ä»£èµ„æ–™ã€‚
    d  åˆ é™¤èµ„æ–™ã€‚
    D  åˆ é™¤ pattern space å†…ç¬¬ä¸€ä¸ª newline å­—æ¯ / å‰çš„èµ„æ–™ã€‚
    g  æ‹·è´èµ„æ–™ä» hold spaceã€‚
    G  æ·»åŠ èµ„æ–™ä» hold space è‡³ pattern space ã€‚
    h  æ‹·è´èµ„æ–™ä» pattern space è‡³ hold space ã€‚
    H  æ·»åŠ èµ„æ–™ä» pattern space è‡³ hold space ã€‚
    l  å°å‡º l èµ„æ–™ä¸­çš„ nonprinting character ç”¨ ASCII ç ã€‚
    i/  æ’å…¥æ·»åŠ ä½¿ç”¨è€…è¾“å…¥çš„èµ„æ–™è¡Œã€‚
    n  è¯»å…¥ä¸‹ä¸€ç¬”èµ„æ–™ã€‚
    N  æ·»åŠ ä¸‹ä¸€ç¬”èµ„æ–™åˆ° pattern spaceã€‚
    p  å°å‡ºèµ„æ–™ã€‚
    P  å°å‡º pattern space å†…ç¬¬ä¸€ä¸ª newline å­—æ¯ / å‰çš„èµ„æ–™ã€‚
    q  è·³å‡º sed ç¼–è¾‘ã€‚
    r  è¯»å…¥å®ƒæ¡£å†…å®¹ã€‚
    s  æ›¿æ¢å­—ä¸²ã€‚
    t label  å…ˆæ‰§è¡Œä¸€æ›¿æ¢çš„ç¼–è¾‘æŒ‡ä»¤ , å¦‚æœæ›¿æ¢æˆç‰›p>åˆ™å°†ç¼–è¾‘æŒ‡ä»¤è·³è‡³ : label å¤„æ‰§è¡Œã€‚
    w  å†™èµ„æ–™åˆ°å®ƒæ¡£å†…ã€‚
    x  äº¤æ¢ hold space ä¸ pattern space å†…å®¹ã€‚
    y  è½¬æ¢(transform)å­—å…ƒã€‚

#####1.åˆ é™¤åŠŸèƒ½ä¸¾ä¾‹ï¼ˆdeleteï¼‰
(1) sed -e '1d' inputfile (åˆ é™¤ç¬¬ä¸€è¡Œ)
    é‚£ä¹ˆåˆ é™¤ç¬¬xè¡Œå‘¢?åˆ é™¤ç¬¬x1,x2,x3è¡Œå‘¢ï¼Ÿ
    sed -e 'xd' inputfile
    sed -e 'x1d' -e 'x2d' -e 'x3d' inputfile
    å½“ç„¶ä¹Ÿè®¸è¿˜æœ‰æ›´å¥½çš„åŠæ³•ã€‚

(2) sed -e '1,3d' file (åˆ é™¤ç¬¬ä¸€åˆ°ç¬¬ä¸‰è¡Œ)
    æ€è€ƒï¼šåˆ é™¤ç¬¬nè¡Œåˆ°ç¬¬mè¡Œ?ä¹Ÿå°±æ˜¯
    sed -e 'n,md' file
    åˆ é™¤ç¬¬ä¸€è¡Œåˆ°æœ€åä¸€è¡Œ
    sed -e '1,$d' file     #$ æœ€åä¸€è¡Œå’Œä¸€è¡Œçš„æœ€å

(3) sed -e '/#/d' file  (åˆ é™¤å«æœ‰'#'å·çš„è¡Œ)
    æ€è€ƒï¼šåˆ é™¤å«æœ‰å­—æ¯xxçš„è¡Œ
    sed -e '/xx/d' file
    æ€è€ƒ: åˆ é™¤é™¤å«æœ‰å­—ç¬¦ä¸²xxçš„æ‰€æœ‰è¡Œ
    sed -e '/xx/!d' file

(4) sed -e '/word1/, /word2/d' file  (åˆ é™¤ä»å«æœ‰å•è¯word1åˆ°å«æœ‰å•è¯word2çš„è¡Œ)
    sed -e '10,/word1/d' file
    åˆ é™¤æ–‡ä»¶ä¸­ä»ç¬¬10è¡Œåˆ°å«æœ‰word1çš„è¡Œ
    sed -e '/word1/,10/d' file
    å’Œä¸Šé¢çš„åŒ¹é…ç›¸åï¼Œåˆ é™¤ä»å«æœ‰word1çš„è¡Œåˆ°ç¬¬10è¡Œ

(5) sed -e '/t.*t/d' file     (åˆ é™¤å«æœ‰ä¸¤ä¸ªtçš„è¡Œ)
    æ€è€ƒï¼šåˆ é™¤å«æœ‰æŒ‡å®šæ­£åœ¨è¡¨è¾¾å¼åŒ¹é…çš„è¡Œã€‚ 

#####2.æ›¿æ¢åŠŸèƒ½ä¸¾ä¾‹ï¼ˆï¼‰
sed å¯æ›¿æ¢æ–‡ä»¶ä¸­çš„å­—ä¸²ã€èµ„æ–™è¡Œã€ç”šè‡³èµ„æ–™åŒºã€‚å…¶ä¸­,è¡¨ç¤ºæ›¿æ¢å­—ä¸²çš„æŒ‡ä»¤ä¸­çš„å‡½æ•°å‚æ•°ä¸º**s**;è¡¨ç¤ºæ›¿æ¢èµ„æ–™è¡Œã€æˆ–èµ„æ–™åŒº>çš„æŒ‡ä»¤ä¸­çš„å‡½æ•°å‚æ•°ä¸º**c**ã€‚ä¸Šè¿°æƒ…å†µä»¥ä¸‹é¢ä¸‰ä¸ªä¾‹å­è¯´æ˜ã€‚