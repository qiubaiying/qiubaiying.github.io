---
layout: post
title: å•ä¾‹æ¨¡å¼-åŒé‡æ£€éªŒé”å®š
subtitle: è®¾è®¡æ¨¡å¼ğŸ™ˆğŸ™ŠğŸ™‰
date: 2019-02-19
author: åä»”
header-img: img/post-bg-debug.png
catalog: false
tags:
    - Java
    - è®¾è®¡æ¨¡å¼
    - å¤šçº¿ç¨‹
---

###  åœ¨å•ä¾‹æ¨¡å¼çš„å®ç°ä¸Šæœ‰ä¸€ç§åŒé‡æ£€éªŒé”å®šçš„æ–¹å¼ï¼ˆDouble-checked Lockingï¼‰

```java
public class Singleton {
    private Singleton() { }
    private volatile static Singleton instance;
    public Singleton getInstance(){
        if(instance==null){
            synchronized (Singleton.class){
                if(instance==null){
                    instance = new Singleton();
                }
            }
        }
        return instance;
    }
}
```

> ä¸ºä»€ä¹ˆè¦åŠ volatileï¼Ÿ

å› ä¸ºï¼šinstance = new Singleton()ä¸­
1. åˆ†é…å¯¹è±¡çš„å†…å­˜ç©ºé—´ï¼›

2. åˆå§‹åŒ–å¯¹è±¡ï¼›

3. è®¾ç½®instanceæŒ‡å‘åˆšåˆ†é…çš„å†…å­˜åœ°å€ã€‚ä½†ç”±äºå­˜åœ¨é‡æ’åºçš„é—®é¢˜ï¼Œå¯èƒ½æœ‰ä»¥ä¸‹çš„æ‰§è¡Œé¡ºåºï¼š

![å› ä¸ºé‡æ’åºå¯èƒ½äº§ç”Ÿçš„æ‰§è¡Œé¡ºåº](http://blog-ipic.yananhuazai.cn/FiZusTpznru1SvoMY882G8z0w9XV "å› ä¸ºé‡æ’åºå¯èƒ½äº§ç”Ÿçš„æ‰§è¡Œé¡ºåº")



å¦‚æœ2å’Œ3è¿›è¡Œäº†é‡æ’åºçš„è¯ï¼Œçº¿ç¨‹Bè¿›è¡Œåˆ¤æ–­if(instance==null)æ—¶å°±ä¼šä¸ºfalseï¼Œè€Œå®é™…ä¸Šè¿™ä¸ªinstanceå¹¶æ²¡æœ‰åˆå§‹åŒ–æˆåŠŸï¼Œæ˜¾è€Œæ˜“è§å¯¹çº¿ç¨‹Bæ¥è¯´ä¹‹åçš„æ“ä½œå°±ä¼šæ˜¯é”™å¾—ã€‚è€Œ**ç”¨volatileä¿®é¥°**çš„è¯å°±å¯ä»¥ç¦æ­¢2å’Œ3æ“ä½œé‡æ’åºï¼Œä»è€Œé¿å…è¿™ç§æƒ…å†µã€‚**volatileåŒ…å«ç¦æ­¢æŒ‡ä»¤é‡æ’åºçš„è¯­ä¹‰ï¼Œå…¶å…·æœ‰æœ‰åºæ€§**ã€‚



> [å‚è€ƒ](https://www.jianshu.com/p/cf57726e77f2)